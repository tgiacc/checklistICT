<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checklist Requisiti Acquisti ICT</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=DM+Serif+Display&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #F4F6FA;
  --bg-card: #FFFFFF;
  --bg-card-hover: #F8FAFC;
  --bg-sidebar: #FFFFFF;
  --border: #E2E8F0;
  --border-light: #CBD5E1;
  --text: #1E293B;
  --text-muted: #475569;
  --text-dim: #94A3B8;
  --accent: #2563EB;
  --accent-glow: rgba(37, 99, 235, 0.1);
  --success: #059669;
  --success-glow: rgba(5, 150, 105, 0.08);
  --warning: #D97706;
  --danger: #DC2626;
  --radius: 12px;
  --radius-sm: 8px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ========= SCROLLBAR ========= */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

/* ========= LAYOUT ========= */
.app { display: flex; min-height: 100vh; }

/* ========= SIDEBAR ========= */
.sidebar {
  width: 280px;
  min-width: 280px;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border);
  box-shadow: 2px 0 12px rgba(0,0,0,0.04);
  padding: 24px 0;
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.sidebar-header {
  padding: 0 20px 24px;
  border-bottom: 1px solid var(--border);
}

.sidebar-logo {
  font-family: 'DM Serif Display', serif;
  font-size: 18px;
  color: var(--text);
  letter-spacing: -0.3px;
  margin-bottom: 4px;
}

.sidebar-logo span { color: var(--accent); }

.sidebar-sub {
  font-size: 11px;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1.2px;
  font-weight: 500;
}

.sidebar-logo-img {
  max-width: 180px;
  height: auto;
  display: block;
}

.sidebar-institutional {
  padding: 16px 20px;
  border-top: 1px solid var(--border);
  margin-top: auto;
}

.sidebar-inst-label {
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--text-dim);
  margin-bottom: 10px;
  font-weight: 500;
}

.sidebar-inst-img {
  max-width: 100%;
  height: auto;
  display: block;
  opacity: 0.85;
}

.sidebar-section-title {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--text-dim);
  padding: 20px 20px 10px;
  font-weight: 600;
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 20px;
  cursor: pointer;
  transition: all 0.2s;
  border-left: 3px solid transparent;
  font-size: 13px;
  color: var(--text-muted);
  position: relative;
}

.sidebar-item:hover {
  background: rgba(0,0,0,0.03);
  color: var(--text);
}

.sidebar-item.active {
  background: var(--accent-glow);
  color: var(--accent);
  border-left-color: var(--accent);
  font-weight: 500;
}

.sidebar-item .icon { font-size: 16px; width: 22px; text-align: center; }

.sidebar-item .badge {
  margin-left: auto;
  background: rgba(0,0,0,0.04);
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 10px;
  color: var(--text-dim);
  font-weight: 600;
}

.sidebar-item.active .badge {
  background: rgba(37, 99, 235, 0.15);
  color: var(--accent);
}

.sidebar-progress {
  margin-top: auto;
  padding: 20px;
  border-top: 1px solid var(--border);
}

.progress-label {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--text-dim);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-weight: 600;
}

.progress-bar {
  height: 6px;
  background: rgba(0,0,0,0.04);
  border-radius: 3px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--success));
  border-radius: 3px;
  transition: width 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  width: 0%;
}

.progress-stats {
  display: flex;
  gap: 16px;
  margin-top: 14px;
}

.stat-mini {
  flex: 1;
  text-align: center;
  padding: 8px;
  background: rgba(0,0,0,0.02);
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
}

.stat-mini-val {
  font-size: 18px;
  font-weight: 700;
  color: var(--text);
  font-family: 'DM Serif Display', serif;
}

.stat-mini-label {
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: var(--text-dim);
  margin-top: 2px;
}

/* ========= MAIN CONTENT ========= */
.main {
  flex: 1;
  padding: 32px 40px;
  max-width: 1100px;
}

.main-header {
  margin-bottom: 32px;
}

.main-header-top {
  display: flex;
  align-items: flex-start;
  gap: 24px;
}

.main-logo-img {
  max-height: 64px;
  width: auto;
  flex-shrink: 0;
  margin-top: 4px;
}

.main-header-text {
  flex: 1;
  min-width: 0;
}

.main-title {
  font-family: 'DM Serif Display', serif;
  font-size: 32px;
  letter-spacing: -0.5px;
  margin-bottom: 8px;
  background: linear-gradient(135deg, #1E293B, #475569);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.main-desc {
  font-size: 14px;
  color: var(--text-muted);
  max-width: 640px;
  line-height: 1.6;
}

/* ========= SEARCH ========= */
.search-bar {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 28px;
}

.search-input {
  flex: 1;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 16px 12px 42px;
  font-size: 14px;
  color: var(--text);
  font-family: inherit;
  transition: border-color 0.2s;
  position: relative;
}

.search-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-glow);
}

.search-input::placeholder { color: var(--text-dim); }

.search-wrap {
  position: relative;
  flex: 1;
}

.search-icon {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-dim);
  font-size: 16px;
  pointer-events: none;
}

.filter-btn {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 18px;
  color: var(--text-muted);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 6px;
}

.filter-btn:hover { border-color: var(--accent); color: var(--text); }
.filter-btn.active { background: var(--accent-glow); border-color: var(--accent); color: var(--accent); }

/* ========= STATS ROW ========= */
.stats-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-bottom: 32px;
}

.stat-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
}

.stat-card:nth-child(1)::before { background: var(--accent); }
.stat-card:nth-child(2)::before { background: var(--success); }
.stat-card:nth-child(3)::before { background: var(--warning); }
.stat-card:nth-child(4)::before { background: #64748B; }

.stat-value {
  font-family: 'DM Serif Display', serif;
  font-size: 28px;
  margin-bottom: 4px;
}

.stat-label {
  font-size: 12px;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-weight: 500;
}

/* ========= SECTION GROUPS ========= */
.section-group {
  margin-bottom: 36px;
  animation: fadeUp 0.4s ease both;
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  user-select: none;
}

.section-header:hover .section-name { color: var(--accent); }

.section-icon { font-size: 20px; }

.section-name {
  font-family: 'DM Serif Display', serif;
  font-size: 20px;
  transition: color 0.2s;
  flex: 1;
}

.section-count {
  font-size: 12px;
  color: var(--text-dim);
  background: rgba(0,0,0,0.04);
  padding: 4px 12px;
  border-radius: 20px;
  font-weight: 500;
}

.section-toggle {
  font-size: 18px;
  color: var(--text-dim);
  transition: transform 0.3s;
}

.section-toggle.collapsed { transform: rotate(-90deg); }

/* ========= REQUIREMENT CARDS ========= */
.req-list { display: flex; flex-direction: column; gap: 8px; }

.req-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px 20px;
  display: flex;
  gap: 14px;
  align-items: flex-start;
  transition: all 0.25s;
  cursor: default;
  box-shadow: 0 1px 3px rgba(0,0,0,0.03);
}

.req-actions-left {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
  padding-top: 2px;
}

.req-card:hover {
  background: var(--bg-card-hover);
  border-color: var(--border-light);
  transform: translateX(3px);
}

.req-card.checked {
  border-color: rgba(5, 150, 105, 0.3);
  background: rgba(5, 150, 105, 0.04);
}

.req-card.checked .req-text { color: var(--text-dim); }

.req-card.na {
  border-color: rgba(148, 163, 184, 0.3);
  background: rgba(148, 163, 184, 0.05);
  opacity: 0.6;
}

.req-card.na .req-text {
  color: var(--text-dim);
  text-decoration: line-through;
  text-decoration-color: rgba(148, 163, 184, 0.5);
}

.req-na {
  flex-shrink: 0;
  padding: 3px 8px;
  border-radius: 5px;
  border: 1px solid var(--border);
  font-size: 10px;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  transition: all 0.2s;
  color: var(--text-dim);
  background: transparent;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  white-space: nowrap;
}

.req-na:hover { border-color: var(--warning); color: var(--warning); }

.req-na.active {
  background: rgba(217, 119, 6, 0.12);
  border-color: var(--warning);
  color: var(--warning);
}

/* Custom checkbox */
.req-check {
  flex-shrink: 0;
  width: 22px;
  height: 22px;
  border-radius: 6px;
  border: 2px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.req-check:hover { border-color: var(--accent); }

.req-check.checked {
  background: var(--success);
  border-color: var(--success);
}

.req-check.checked::after {
  content: '‚úì';
  color: white;
  font-size: 13px;
  font-weight: 700;
}

.req-body { flex: 1; min-width: 0; }

.req-subtopic {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  margin-bottom: 6px;
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  background: rgba(0,0,0,0.04);
}

.req-text {
  font-size: 13.5px;
  line-height: 1.65;
  color: var(--text-muted);
  transition: color 0.2s;
}

.req-ref {
  margin-top: 10px;
  font-size: 11px;
  color: var(--text-dim);
  padding-top: 8px;
  border-top: 1px solid rgba(0,0,0,0.04);
  line-height: 1.5;
  display: none;
}

.req-card.expanded .req-ref { display: block; }

.req-fonte-link {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  margin-top: 6px;
  font-size: 12px;
  font-weight: 500;
  color: var(--accent);
  text-decoration: none;
  transition: all 0.2s;
}

.req-fonte-link:hover {
  color: #1D4ED8;
  text-decoration: underline;
}

.req-expand {
  flex-shrink: 0;
  width: 28px;
  height: 28px;
  border-radius: 6px;
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--text-dim);
  font-size: 12px;
  transition: all 0.2s;
}

.req-expand:hover { background: rgba(0,0,0,0.04); color: var(--text); }

/* ========= EMPTY STATE ========= */
.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-dim);
}

.empty-state .icon { font-size: 40px; margin-bottom: 16px; opacity: 0.5; }
.empty-state p { font-size: 14px; }

/* ========= RESPONSIVE ========= */
@media (max-width: 900px) {
  .sidebar { display: none; }
  .main { padding: 20px; }
  .stats-row { grid-template-columns: repeat(2, 1fr); }
  .main-title { font-size: 24px; }
}


/* ========= AUTH OVERLAY ========= */
.auth-overlay {
  position: fixed; inset: 0; z-index: 9999;
  background: var(--bg);
  display: flex; align-items: center; justify-content: center;
}
.auth-box {
  background: #fff; border-radius: 16px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.12);
  padding: 48px 40px; width: 100%; max-width: 420px;
  text-align: center;
}
.auth-box h2 {
  font-family: 'DM Serif Display', serif;
  font-size: 26px; margin-bottom: 6px;
  background: linear-gradient(135deg, #1E293B, #475569);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.auth-box .auth-sub { font-size: 13px; color: var(--text-muted); margin-bottom: 28px; }
.auth-field {
  display: block; width: 100%; padding: 12px 14px;
  border: 1px solid var(--border); border-radius: 8px;
  font-size: 14px; margin-bottom: 12px;
  font-family: 'DM Sans', sans-serif;
  box-sizing: border-box;
}
.auth-field:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
.auth-btn {
  display: block; width: 100%; padding: 12px;
  background: var(--accent); color: #fff; border: none;
  border-radius: 8px; font-size: 14px; font-weight: 600;
  cursor: pointer; margin-top: 8px;
  font-family: 'DM Sans', sans-serif;
}
.auth-btn:hover { background: #1D4ED8; }
.auth-toggle { font-size: 13px; color: var(--text-muted); margin-top: 16px; }
.auth-toggle a { color: var(--accent); cursor: pointer; text-decoration: none; font-weight: 500; }
.auth-error { color: #DC2626; font-size: 12px; margin-top: 8px; min-height: 18px; }

/* ========= COMPILAZIONI BAR ========= */
.compilazioni-bar {
  display: flex; align-items: center; gap: 12px;
  padding: 14px 20px; margin-bottom: 24px;
  background: #fff; border-radius: 12px;
  border: 1px solid var(--border);
  box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  flex-wrap: wrap;
}
.compilazioni-bar label {
  font-size: 12px; font-weight: 600;
  color: var(--text-dim); text-transform: uppercase;
  letter-spacing: 0.8px; white-space: nowrap;
}
.compilazioni-select {
  flex: 1; min-width: 200px; padding: 8px 12px;
  border: 1px solid var(--border); border-radius: 8px;
  font-size: 13px; font-family: 'DM Sans', sans-serif;
  background: #fff; color: var(--text);
}
.compilazioni-select:focus { outline: none; border-color: var(--accent); }
.comp-btn {
  padding: 8px 14px; border-radius: 8px;
  font-size: 12px; font-weight: 600; cursor: pointer;
  border: 1px solid var(--border); background: #fff;
  color: var(--text-muted); white-space: nowrap;
  font-family: 'DM Sans', sans-serif;
  transition: all 0.2s;
}
.comp-btn:hover { background: var(--bg); }
.comp-btn.primary { background: var(--accent); color: #fff; border-color: var(--accent); }
.comp-btn.primary:hover { background: #1D4ED8; }
.comp-btn.danger { color: #DC2626; border-color: #FCA5A5; }
.comp-btn.danger:hover { background: #FEF2F2; }

/* ========= USER PILL (sidebar) ========= */
.user-pill {
  display: flex; align-items: center; gap: 10px;
  padding: 12px 20px; border-top: 1px solid var(--border);
  margin-top: auto;
}
.user-avatar {
  width: 32px; height: 32px; border-radius: 50%;
  background: var(--accent); color: #fff;
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 13px; flex-shrink: 0;
}
.user-info { flex: 1; min-width: 0; }
.user-email { font-size: 11px; color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.user-logout {
  font-size: 11px; color: var(--accent); cursor: pointer;
  border: none; background: none; padding: 0;
  font-family: 'DM Sans', sans-serif; font-weight: 500;
}
.user-logout:hover { text-decoration: underline; }

/* ========= LOADING SPINNER ========= */
.loading-overlay {
  position: fixed; inset: 0; z-index: 9998;
  background: var(--bg);
  display: flex; align-items: center; justify-content: center;
  flex-direction: column; gap: 16px;
}
.spinner {
  width: 40px; height: 40px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading-text { font-size: 13px; color: var(--text-muted); }

/* Hide app until ready */
.app-hidden { display: none !important; }

/* ========= ANIMATIONS ========= */
.req-card { animation: cardIn 0.3s ease both; }
.section-group:nth-child(2) { animation-delay: 0.05s; }
.section-group:nth-child(3) { animation-delay: 0.1s; }
.section-group:nth-child(4) { animation-delay: 0.15s; }

@keyframes cardIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.glow-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  display: inline-block;
  margin-right: 6px;
  vertical-align: middle;
}
</style>
</head>
<body>


<!-- LOADING -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="spinner"></div>
  <div class="loading-text">Caricamento...</div>
</div>

<!-- FAILSAFE: independent script, runs even if main script crashes -->
<script>
(function(){
  var t = setTimeout(function(){
    var lo = document.getElementById('loadingOverlay');
    var ao = document.getElementById('authOverlay');
    if (lo && lo.style.display !== 'none') {
      lo.style.display = 'none';
      if (ao) ao.style.display = 'flex';
      console.warn('CheckICT failsafe: timeout 4s, mostro login.');
    }
  }, 4000);
  window._clearInitTimeout = function(){ clearTimeout(t); };
})();
</script>

<!-- AUTH OVERLAY -->
<div class="auth-overlay" id="authOverlay" style="display:none">
  <div class="auth-box">
    <h2>CheckICT</h2>
    <p class="auth-sub">Accedi per gestire le tue checklist di acquisto</p>
    <div id="authFormLogin">
      <input class="auth-field" type="email" id="authEmail" placeholder="Email">
      <input class="auth-field" type="password" id="authPassword" placeholder="Password">
      <button class="auth-btn" onclick="doLogin()">Accedi</button>
      <div class="auth-toggle">Non hai un account? <a onclick="showRegister()">Registrati</a></div>
      <div class="auth-error" id="authError"></div>
    </div>
    <div id="authFormRegister" style="display:none">
      <input class="auth-field" type="email" id="regEmail" placeholder="Email">
      <input class="auth-field" type="password" id="regPassword" placeholder="Password (min. 6 caratteri)">
      <input class="auth-field" type="password" id="regPassword2" placeholder="Conferma password">
      <button class="auth-btn" onclick="doRegister()">Crea account</button>
      <div class="auth-toggle">Hai gi√† un account? <a onclick="showLogin()">Accedi</a></div>
      <div class="auth-error" id="regError"></div>
    </div>
  </div>
</div>

<div class="app app-hidden" id="appContainer">
  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar"></aside>

  <!-- MAIN -->
  <main class="main">
    <div class="main-header">
      <div class="main-header-top">
        <img src="data:image/png;base64,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XbXN1L2Pmc5gsCTZXcDXNja12tkREWhbUREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREVbbd80vWGW21VFl9Tc+qqHxydnj540DdRpvCslQ/afgdJndHQ01XcKiiFJK6RpiaCXajTQ6rF17ZKDiTJ30r205s/du3qj+3lnX/wCq8mPpL+dvLOuu1eTH0lN/Y92fujuPimJ7Huz90dx8UxarPXGe4+0fPP3BQjt5Z112ryY+knbyzrrtXkx9JTf2Pdn7o7j4piex7s/dHcfFMSz09x9o+efuChHbyzrrtXkx9JO3lnXXavJj6Sm/se7P3R3HxTE9j3Z+6O4+KYlnp7j7R88/cFCO3lnXXavJj6SdvLOuu1eTH0lN/Y92fujuPimJ7Huz90dx8UxLPT3H2j55+4KEdvLOuu1eTH0k7eWdddq8mPpKb+x7s/dHcfFMT2Pdn7o7j4piWenuPtHzz9wUI7eWdddq8mPpJ28s667V5MfSU39j3Z+6O4+KYnse7P3R3HxTEs9PcfaPnn7goR28s667V5MfSTt5Z112ryY+kpv7Huz90dx8UxPY92fujuPimJZ6e4+0fPP3BQjt5Z112ryY+knbyzrrtXkx9JTf2Pdn7o7j4piex7s/dHcfFMSz09x9o+efuChHbyzrrtXkx9JSrZrtUyvILnV09wNv5kUAkb2OAtOvOA617fY92fujuPimLuYfsdtuN1s9VBe62czRdjLXxtGm/XXd4F60Pvmp2G0mNsqmOqXEs3/MCuj667v+7eLPnT113f8AdvFnzrq+sym+XT/yhPWZTfLp/wCULcuzXK9dd3/dvFnzp667v+7eLPnXV9ZlN8un/lCesym+XT/yhEXK9dd3/dvFnzp667v+7eLPnXV9ZlN8un/lCesym+XT/wAoRFyvXXd/3bxZ86euu7/u3iz511fWZTfLp/5QnrMpvl0/8oRFyvXXd/3bxZ86euu7/u3iz511fWZTfLp/5QnrMpvl0/8AKERcr113f928WfOnrru/7t4s+ddX1mU3y6f+UJ6zKb5dP/KERcr113f928WfOnrru/7t4s+ddX1mU3y6f+UJ6zKb5dP/AChE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zK9jdMT87QB0G/kFXFRNFBysGyTyxxMGP6c57g0e66yrZ/Sls/aNH49vnUXzHZdhmXXk3e+22SpqzE2IuFQ9g5rddNzSB0lcU7BdmJGn6Dm8sl9JSZJKWZrNtxBAA0B07QtDGTxl2yAQSTqfRSfaXlVPiuAXPIxLG8w059T6OBD5HbmAde8hcDk9YrNjWAQ1NwBN2u7zX1rne65z97WnwA/WSu5ctn2LXHHrTj9ZQyS2u0vY+lpzO8N1Z7nnb/badRUqAAAAAAHABaDMxsBiZvNz1DT1K3CJzpeEduGXbqqe5Q1vmstwsG0+3RudPYalrK5rOMlK46H6tT9atm21lPcbfT19JIJKeoibLE8fCa4ag/avnerbRXm01VquMAno6qIxTRk6c5pG8bl8MXsdvxuxUtktTJGUVK3mQskkLy1uuump36b15JM2SBrT9TfD+j4r1kRZK5w0Pj/0umqh5Rf622ff+4o/uVvLiZRi1lyWa2TXemfM+2VQq6Utkc3mSDgTod/gK8pJmwzB7tM/BKmMyxlo6PFdtRnajlMGG4Lc7/KQZIYubTs193K7cwfWfqBUmXBzLEbFl9NSU1+pX1UFJUCojjErmtLxwLgD7Yd4rXAYxI0yfTvWcoeWEM1UZ5PeNT49s7p57g3W6XaR1wrXn3TnSbwD4BouFyh6WewV+PbTbZE51TZKoRVgZxkppDo4H69P9SuBoDWhrQAANAB0LyXu2UN6tFVabnTtqKOriMU0buDmnipDKw+88M8anMdB1HctLqYcBwTd2nWN/evpa62muVtprhRyCSnqYmyxPHS1w1H3r0LmYtYrfjViprJamSsoqYFsLJJC8tBOump36b101Efs7R2dFIbew2tUREWKyREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREX//2Q==" alt="Formez PA" class="main-logo-img">
        <div class="main-header-text">
          <h1 class="main-title">Checklist Requisiti Acquisti ICT</h1>
          <p class="main-desc">Strumento di verifica dei requisiti normativi per gli acquisti di beni e servizi ICT nei comuni italiani. Seleziona una sezione per consultare i requisiti applicabili.</p>
        </div>
      </div>
    </div>


    <!-- COMPILAZIONI BAR -->
    <div class="compilazioni-bar" id="compilazioniBar">
      <label>üìÅ Acquisto</label>
      <select class="compilazioni-select" id="compSelect" onchange="switchCompilazione()">
        <option value="">‚Äî Seleziona o crea ‚Äî</option>
      </select>
      <button class="comp-btn primary" onclick="newCompilazione()">+ Nuovo</button>
      <button class="comp-btn" onclick="renameCompilazione()">‚úèÔ∏è Rinomina</button>
      <button class="comp-btn danger" onclick="deleteCompilazione()">üóëÔ∏è Elimina</button>
    </div>

    <div class="search-bar">
      <div class="search-wrap">
        <span class="search-icon">üîç</span>
        <input class="search-input" type="text" placeholder="Cerca requisiti, norme, temi..." id="searchInput">
      </div>
      <button class="filter-btn" id="btnShowChecked" onclick="toggleShowChecked()">
        ‚úì Completati
      </button>
      <button class="filter-btn" id="btnShowUnchecked" onclick="toggleShowUnchecked()">
        ‚óã Da fare
      </button>
      <button class="filter-btn" id="btnShowNA" onclick="toggleShowNA()">
        ‚äò N/A
      </button>
    </div>

    <div class="stats-row" id="statsRow"></div>

    <div id="content"></div>
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONFIGURAZIONE SUPABASE ‚Äî Inserire le proprie credenziali
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SUPABASE_URL  = 'YOUR_SUPABASE_URL';   // es. https://xyz.supabase.co
const SUPABASE_ANON = 'YOUR_SUPABASE_ANON_KEY';

let sbClient;
let _supabaseError = null;
try {
  if (!window.supabase) throw new Error('Supabase JS non caricato. Verifica la connessione internet.');
  if (SUPABASE_URL === 'YOUR_SUPABASE_URL') throw new Error('Configurazione mancante: inserire SUPABASE_URL e SUPABASE_ANON_KEY nel codice.');
  sbClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
} catch(e) {
  _supabaseError = e.message;
  // DOM is already loaded (script is at bottom of body), manipulate directly
  const lo = document.getElementById('loadingOverlay');
  if (lo) {
    const txt = lo.querySelector('.loading-text');
    const sp = lo.querySelector('.spinner');
    if (txt) txt.textContent = '‚ö†Ô∏è ' + e.message;
    if (sp) sp.style.display = 'none';
  }
}

// Auth & compilazione state
let currentUser = null;
let currentCompId = null;
let compilazioni = [];
let _saveTimeout = null;

const DATA = [{"id": 1, "use_case": "Requisiti Trasversali", "section": "Acquisizione e riuso software", "subtopic": "Sicurezza by design", "requisito": "L‚Äôadozione di un Secure Software Development Life Cycle (SSDLC) atto a considerare e implementare opportune attivit√† di sicurezza, nel corso di tutte le sue fasi del ciclo di vita del SW (dall‚Äôanalisi fino alla manutenzione), √® una necessit√† inderogabile per rispondere in modo efficace alle problematiche di sicurezza.", "ref": "Fonte: Linee Guida per l‚Äôadozione di un ciclo di sviluppo di software sicuro, par. 4.2", "fonte": "Linee Guida per l'adozione di un ciclo di sviluppo software sicuro"}, {"id": 2, "use_case": "Siti web istituzionali e portali tematici", "section": "Acquisizione e riuso software", "subtopic": "Generale", "requisito": "Nell'acquisire software, l'ente:\na) effettua una valutazione comparativa tecnico economica, motivando le proprie scelte e privilegiando le soluzioni open source, comprese quelle messe a disposizione dalle altre amministrazioni;\nb) sviluppa o fa sviluppare codice sempre con licenza aperta;\nc) pubblica le soluzioni riusabili in una repository pubblicamente accessibile e le inserisce nel catalogo Developers Italia.\nPer maggiori dettagli sullo pubblicazione, manutenzione e modifica di risorse open source, si invita l'utente a consultare gli allegati B (Guida alla pubblicazione open source di software realizzato per la PA), C (Guida alla manutenzione di software open source), E (Guida alla modifica di software open source preso a riuso da terzi) messi a disposizione da AgID all'indirizzo https://www.agid.gov.it/it/design-servizi/riuso-open-source/linee-guida-acquisizione-riuso-software-pa", "ref": "Fonte: Linee guida acquisizione e riuso software PA", "fonte": "Linee Guida acquisizione e riuso software PA"}, {"id": 3, "use_case": "Software gestionali verticali", "section": "Cloud qualificato/hosting", "subtopic": "Qualificazione infrastrutture Cloud", "requisito": "I servizi digitali devono utilizzare esclusivamente infrastrutture digitali adeguate e servizi cloud qualificati (o adeguati) da ACN. Per le specifiche in merito alle infrastrutture sulle quali devono essere erogati i servizi in base alla loro classificazione, consultare l'art. 12 c. 4", "ref": "Fonte: Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni, art. 9, c. 1; art. 12, c.4", "fonte": "Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni"}, {"id": 4, "use_case": "Documentale e Protocollo", "section": "Cloud qualificato/hosting", "subtopic": "Classificazione dati e servizi", "requisito": "Tutti i dati e i servizi digitali devono essere classificati in \"ordinari,\" \"critici,\" o \"strategici\".", "ref": "Fonte: Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni, art. 3, c. 2", "fonte": "Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni"}, {"id": 5, "use_case": "Pagamenti digitali", "section": "Cloud qualificato/hosting", "subtopic": "Classificazione dati e servizi", "requisito": "I dati e i servizi digitali devono essere classificati con revisione almeno biennale e trasmissione ad ACN.", "ref": "Fonte: Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni, art. 5, c. 1", "fonte": "Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni"}, {"id": 6, "use_case": "Identit√† digitale (SPID/CIE/SSO)", "section": "Cloud qualificato/hosting", "subtopic": "Classificazione dati e servizi", "requisito": "I servizi digitali non ancora classificati non possono essere resi disponibili agli utenti finali.", "ref": "Fonte: Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni, art. 3, c. 6", "fonte": "Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni"}, {"id": 7, "use_case": "Cloud qualificato/hosting", "section": "Comunicazione digitale", "subtopic": "Principio 'Once only'", "requisito": "Qualunque dato trattato da una pubblica amministrazione √® reso accessibile e fruibile alle altre amministrazioni quando l'utilizzazione del dato sia necessaria per lo svolgimento dei compiti istituzionali dell'amministrazione richiedente, senza oneri a carico di quest'ultima salvo  per la prestazione di elaborazioni aggiuntive.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 50, c. 2", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 8, "use_case": "Cybersecurity", "section": "Comunicazione digitale", "subtopic": "Open Data e dati dinamici", "requisito": "Gli enti pubblici rendono disponibili i dati dinamici per il riutilizzo immediatamente dopo la raccolta tramite API adeguate e, se del caso, come download in blocco.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5, c. 5", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 9, "use_case": "Comunicazione digitale", "section": "Comunicazione digitale", "subtopic": "Open Data e dati dinamici", "requisito": "Se rendere disponibili i dati dinamici per il riutilizzo immediatamente dopo la raccolta di cui al paragrafo 5 eccede le capacit√† finanziarie e tecniche dell'ente pubblico, imponendo in tal modo uno sforzo sproporzionato, tali dati dinamici sono resi disponibili per il riutilizzo entro un termine o con temporanee restrizioni tecniche che non pregiudichino indebitamente lo sfruttamento del loro potenziale economico e sociale.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5, c. 6", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 10, "use_case": "IoT / Smart Land / Data Platform urbana", "section": "Comunicazione digitale", "subtopic": "Open Data e dati dinamici", "requisito": "I dati raccolti devono essere resi disponibili pubblicamente in formato aperto, leggibile da macchina e interoperabile.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5, c. 1", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 11, "use_case": "Intelligenza Artificiale (IA)", "section": "Comunicazione digitale", "subtopic": "Open Data e formati", "requisito": "Sia il formato che i metadati sono, ove possibile, conformi a standard formali aperti.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5, c. 1", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 12, "use_case": "", "section": "Comunicazione digitale", "subtopic": "Open Data e dati dinamici", "requisito": "Le serie di dati di elevato valore sono messe a disposizione per il riutilizzo in formato leggibile meccanicamente, tramite opportune API e, se del caso, come download in blocco.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5, c. 8", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 13, "use_case": "", "section": "Cybersecurity", "subtopic": "Gestione inventario Hardware", "requisito": "Tutti i sistemi e gli apparati fisici devono essere censiti e l'accesso alla rete √® consentito esclusivamente a quelli approvati.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), ABSC 1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 14, "use_case": "", "section": "Cybersecurity", "subtopic": "Gestione inventario Software", "requisito": "Tutte le piattaforme e le applicazioni software installate devono essere censite ed esiste un elenco di quelle approvate da attori interni al soggetto.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), ABSC 2", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 15, "use_case": "", "section": "Cybersecurity", "subtopic": "Gestione inventario Software", "requisito": "L'installazione delle piattaforme e delle applicazioni software √® consentita esclusivamente per quelle approvate.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), ABSC 2", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 16, "use_case": "", "section": "Cybersecurity", "subtopic": "Antivirus/Anti-malware", "requisito": "Devono essere implementati ed utilizzati appositi strumenti per la prevenzione e il rilevamento di malware, nonch√© sistemi di protezione delle postazioni terminali (Endpoint Protection System - EPS).", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), ABSC 8", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 17, "use_case": "", "section": "Cybersecurity", "subtopic": "Gestione privilegi", "requisito": "Utenze privilegiate, credenziali di accesso e diritti amministrativi seguono le Misure Minime di Sicurezza ICT ad ABSC 5.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.AC-01.1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 18, "use_case": "", "section": "Cybersecurity", "subtopic": "Sicurezza remota", "requisito": "Gli accessi da remoto effettuati devono essere monitorati da parte dell'organizzazione di cybersecurity.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.AC-03.1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 19, "use_case": "", "section": "Cybersecurity", "subtopic": "Autenticazione Multifattoriale (MFA)", "requisito": "Devono essere impiegati modalit√† di autenticazione a fattore multiplo per gli accessi amministrativi (livello Alto) oppure, per il livello Minimo, credenziali di elevata robustezza se l'MFA non √® supportata.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.AC-03.5", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 20, "use_case": "", "section": "Cybersecurity", "subtopic": "Backup e ripristino", "requisito": "Viene effettuato periodicamente un backup delle informazioni memorizzate, assicurando riservatezza, integrit√† e disponibilit√† dei dati di backup.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.IP-04.1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 21, "use_case": "", "section": "Cybersecurity", "subtopic": "Patch management", "requisito": "Deve essere sviluppato e implementato un piano di gestione delle vulnerabilit√†.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.IP-12", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 22, "use_case": "", "section": "Cybersecurity", "subtopic": "Registrazione log", "requisito": "I log devono essere conservati in modo sicuro in un repository centrale (syslog) e stabilmente archiviati.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), PR.PT-01.1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 23, "use_case": "", "section": "Cybersecurity", "subtopic": "Patch management", "requisito": "Le vulnerabilit√† sono mitigate secondo quanto previsto dal piano di gestione delle vulnerabilit√† (PR.IP-12), ovvero ne viene documentato e accettato il rischio residuo derivante dalla mancata mitigazione.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni), RS.MI-03.1", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 24, "use_case": "", "section": "Cybersecurity", "subtopic": "Generale", "requisito": "L'ente deve assicurare il rispetto di tutte le altre disposizioni contenute all'interno della Circolare 18 aprile 2017, n.2/2017.", "ref": "Fonte: Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)", "fonte": "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)"}, {"id": 25, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Integrazione CIE/SPID", "requisito": "L'ente deve utilizzare esclusivamente le identit√† digitali SPID e la CIE ai fini dell'identificazione dei cittadini che accedono ai propri servizi in rete.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 64, c.2-quater, c. 3-bis", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 26, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Accesso esclusivo", "requisito": "√à fatto divieto di rilasciare o rinnovare credenziali diverse da SPID, CIE o CNS per l'identificazione dei cittadini.", "ref": "Fonte: Decreto-legge 16 luglio 2020, n. 76 (Misure urgenti per la semplificazione e l'innovazione digitale), art. 24, c. 4", "fonte": "Decreto-legge 16 luglio 2020, n. 76 (Misure urgenti per la semplificazione e l'innovazione digitale)"}, {"id": 27, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Standard OIDC Federation", "requisito": "L'integrazione deve avvenire adottando le specifiche tecniche OpenID Connect Federation 1.0 (OIDC-FED) ed estendendo le funzionalit√† secondo le regole tecniche SPID.", "ref": "Fonte: SPID OpenID Connect Federation, par. La Federazione OpenID Connect SPID", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 28, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Esposizione Entity Configuration", "requisito": "Tutti i partecipanti (RP, OP, SA) devono pubblicare la propria configurazione (Entity Configuration) presso il percorso web pubblico .well-known/openid-federation.", "ref": "Fonte: SPID OpenID Connect Federation, par. Configurazione della Federazione SPID; par. Endpoint comuni a tutti,,", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 29, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Algoritmi crittografici ammessi", "requisito": "La soluzione deve supportare gli algoritmi crittografici obbligatori (es. RS256) e non deve supportare algoritmi insicuri.", "ref": "Fonte: SPID OpenID Connect Federation, par. Algoritmi crittografici", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 30, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Validazione Trust Marks", "requisito": "L'OpenID Provider (OP) deve rifiutare l'autorizzazione se il Relying Party (RP) non espone un Trust Mark valido all'interno della sua configurazione; la validazione del Trust Mark √® obbligatoria come deterrente contro gli abusi.", "ref": "Fonte: SPID OpenID Connect Federation, par. OpenID Provider; par. Considerazioni di Sicurezza", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 31, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Lunghezza chiavi RSA", "requisito": "La lunghezza delle chiavi RSA utilizzate per le operazioni di firma e cifratura deve essere pari o superiore a 2048 bit (raccomandati 4096 bit).", "ref": "Fonte: SPID OpenID Connect Federation, par. Algoritmi crittografici", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 32, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Logging Trust Chain", "requisito": "Gli OP e gli RP devono registrare nel registro delle transazioni (log) l'intera Trust Chain relativa all'Entit√† con la quale √® avvenuta la transazione (inclusi Entity Configuration ed Entity Statement).", "ref": "Fonte: SPID OpenID Connect Federation, par. Gestione dei Log di un OP e di un RP", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 33, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Endpoint Resolve Entity Statement", "requisito": "Tutti i partecipanti devono esporre un endpoint 'Resolve Entity Statement' per rendere noti i metadati, i Trust Mark e la Trust Chain relativi alle entit√† da essi riconosciute.", "ref": "Fonte: SPID OpenID Connect Federation, par. Endpoint comuni a tutti", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 34, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Gestione Trust Chain Scadute", "requisito": "In caso di irraggiungibilit√† dei servizi di federazione, √® consentito utilizzare le Trust Chain scadute per un periodo di grazia massimo di 24 ore successive al primo tentativo di aggiornamento fallito.", "ref": "Fonte: SPID OpenID Connect Federation, par. Periodo di grazia per le Trust Chain scadute", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 35, "use_case": "", "section": "Identit√† digitale (SPID/CIE/SSO)", "subtopic": "Generale", "requisito": "L'ente deve assicurare il rispetto di tutte le disposizioni contenute all'interno delle Regole tecniche per il funzionamento della Federazione SPID OpenID Connect.", "ref": "Fonte: SPID OpenID Connect Federation", "fonte": "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)"}, {"id": 36, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Qualit√† dei dati e bias", "requisito": "I sistemi di IA ad alto rischio devono essere addestrati su set di dati pertinenti, rappresentativi e, per quanto possibile, esenti da errori e completi, al fine di attenuare possibili distorsioni.", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 10, par. 2, lett. f), art. 10, par. 3; Legge n. 132/2025: art. 3, c. 1", "fonte": "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)"}, {"id": 37, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Logging e sorveglianza umana", "requisito": "I sistemi di IA ad alto rischio devono consentire a livello tecnico la registrazione automatica degli eventi (\"log\") per la durata del ciclo di vita del sistema.", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 12, par. 1, art. 19, art. 26, par. 6", "fonte": "Regolamento (UE) 2024/1689 (regolamento sull'intelligenza artificiale)"}, {"id": 38, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Logging e sorveglianza umana", "requisito": "I sistemi di IA ad alto rischio devono essere progettati per consentire una sorveglianza umana efficace durante il periodo in cui sono in uso.", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 14, par. 1, 2 e 4, Legge n. 132/2025, art. 3, c. 3", "fonte": "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)"}, {"id": 39, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Valutazione d'impatto", "requisito": "Per i sistemi di IA ad Alto Rischio, gli organismi di diritto pubblico (e altri soggetti specifici) devono effettuare una valutazione d'impatto sui diritti fondamentali prima dell'uso.", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 27, par. 1, par. 3", "fonte": "Regolamento (UE) 2024/1689 (regolamento sull'intelligenza artificiale)"}, {"id": 40, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Valutazione d'impatto", "requisito": "I deployer devono effettuare una DPIA, se richiesto dal GDPR, utilizzando le informazioni fornite dal fornitore del sistema IA.", "ref": "Fonte:Regolamento (UE) 2024/1689, art. 26, par. 9, art. 27, par. 4; Legge n. 132/2025, art. 8, c. 5", "fonte": "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)"}, {"id": 41, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Trasparenza e marcatura", "requisito": "I fornitori devono garantire che gli output di IA generativa (audio, video, testo) siano marcati in un formato leggibile meccanicamente per essere rilevabili come generati artificialmente.", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 50, par. 2", "fonte": "Regolamento (UE) 2024/1689 (regolamento sull'intelligenza artificiale)"}, {"id": 42, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Trasparenza e marcatura", "requisito": "I deployer devono rendere noto in modo chiaro e distinto che il contenuto √® stato generato o manipolato artificialmente (deepfake).", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 50, par. 4; Legge n. 132/2025, art. 26, c. 1, art. 13", "fonte": "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)"}, {"id": 43, "use_case": "", "section": "Intelligenza Artificiale (IA)", "subtopic": "Classificazione del rischio", "requisito": "Prima dell'acquisto o della messa in esercizio, i sistemi di IA devono essere classificati in base alle categorie di rischio (es. alto rischio, vietati).", "ref": "Fonte: Regolamento (UE) 2024/1689, art. 5, art. 6; Allegato I, Allegato III; Legge n. 132/2025, art. 2", "fonte": "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)"}, {"id": 44, "use_case": "", "section": "IoT / Smart Land / Data Platform urbana", "subtopic": "Open Data e formati", "requisito": "I dati raccolti da sensori rientrano nella definizione di dati dinamici.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 2", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 45, "use_case": "", "section": "IoT / Smart Land / Data Platform urbana", "subtopic": "Dati territoriali (RNDT)", "requisito": "Le amministrazioni devono alimentare e aggiornare il Repertorio Nazionale dei Dati Territoriali (RNDT) con i relativi metadati.", "ref": "Fonte: Linee Guida recanti regole tecniche per la definizione e l‚Äôaggiornamento del contenuto del Repertorio Nazionale dei Dati Territoriali, par. 3.4", "fonte": "Linee Guida recanti regole tecniche per la definizione e l‚Äôaggiornamento del contenuto del Repertorio Nazionale dei Dati Territoriali"}, {"id": 46, "use_case": "", "section": "IoT / Smart Land / Data Platform urbana", "subtopic": "Dati territoriali (RNDT)", "requisito": "L'aggiornamento del RNDT deve avvenire entro tre mesi dall‚Äôacquisizione di nuovi dati o dall'aggiornamento di dati esistenti.", "ref": "Fonte: Linee Guida recanti regole tecniche per la definizione e l‚Äôaggiornamento del contenuto del Repertorio Nazionale dei Dati Territoriali, par. 3.4", "fonte": "Linee Guida recanti regole tecniche per la definizione e l‚Äôaggiornamento del contenuto del Repertorio Nazionale dei Dati Territoriali"}, {"id": 47, "use_case": "", "section": "IoT / Smart Land / Data Platform urbana", "subtopic": "Open Data e dati dinamici", "requisito": "Sono valide le disposizioni elencate all'interno della sezione \"Comunicazione digitale\" di questa checklist.", "ref": "Fonte: Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio, art. 5", "fonte": "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico"}, {"id": 48, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Pagamento elettronico obbligatorio", "requisito": "L'ente √® obbligato ad accettare i pagamenti spettanti a qualsiasi titolo attraverso sistemi di pagamento elettronico, ivi inclusi, per i micro-pagamenti, quelli basati sull'uso del credito telefonico. Una piattaforma tecnologica interconnessa e interoperabile (pagoPA) √® messa a diposizione per assicurare l'autenticazione dei soggetti interessati all'operazione in tutta la gestione del processo di pagamento.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 5, c. 1, c. 2", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 49, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Codice Identificativo Univoco (IUV)", "requisito": "La soluzione software deve supportare la specifica dei codici identificativi del pagamento (IUV) secondo le Linee Guida AgID, per garantire l'univocit√† del versamento e la riconciliazione automatica.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 5, c. 4", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 50, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Gestione pagamenti spontanei", "requisito": "Il sistema deve consentire di effettuare tramite la piattaforma nazionale non solo i pagamenti \"dovuti\" (con avviso predeterminato), ma anche il pagamento spontaneo di tributi e oneri (es. in assenza di avviso bonario).", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), Art. 5, comma 2-ter", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 51, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Supporto micropagamenti", "requisito": "La soluzione deve permettere l'accettazione di pagamenti elettronici inclusi quelli per i micro-pagamenti, compresi quelli basati sull'uso del credito telefonico.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), Art. 5, comma 1", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 52, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Autenticazione integrata (SPID/CIE)", "requisito": "La piattaforma di pagamento deve assicurare l'autenticazione del soggetto pagatore attraverso gli strumenti di identit√† digitale previsti dall'art. 64 (SPID, Carta d'Identit√† Elettronica).", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), Art. 5, comma 2; Art. 64, comma 2-quater", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 53, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Riconciliazione automatica dei flussi", "requisito": "Il sistema deve essere in grado di ricevere e processare le informazioni sui pagamenti messe a disposizione dai prestatori di servizi (PSP) tramite la piattaforma, permettendo l'aggiornamento automatico dello stato contabile e la rendicontazione (anche verso la Ragioneria Generale dello Stato).", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), Art. 5, comma 4; Art. 5, comma 2-quinquies", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 54, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Integrazione con ciclo fatturazione", "requisito": "La piattaforma pu√≤ essere utilizzata per automatizzare i processi di certificazione fiscale, inclusa la fatturazione elettronica e la memorizzazione dei corrispettivi giornalieri; il software acquistato dovrebbe idealmente supportare questo flusso integrato.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), Art. 5, comma 2-sexies", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 55, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Utilizzo strumentale CIE/CNS", "requisito": "La Carta d'Identit√† Elettronica (CIE) e la Carta Nazionale dei Servizi (CNS) devono poter essere utilizzate come strumenti di autenticazione telematica per l'effettuazione dei pagamenti verso le PA.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 66, c. 5, art. 64, c. 2-nonies", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 56, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Predisposizione IT-Wallet", "requisito": "La soluzione deve essere predisposta per integrarsi con il \"Sistema di portafoglio digitale italiano (Sistema IT-Wallet)\", che valorizza l'interoperabilit√† tra banche dati e favorisce l'utilizzo di servizi in rete tramite il punto di accesso telematico (App IO).", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82, art. 64-quater, c. 1, c. 2", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 57, "use_case": "", "section": "Pagamenti digitali", "subtopic": "Specifiche e documentazione tecnica", "requisito": "Occorre assicurare il rispetto deglle regole, standard e specifiche tecniche che le PA e i prestatori dei servizi di pagamento (PSP) devono seguire per integrarsi al sistema pagoPA contenute nelle Linee Guida per l'effettuazione dei pagamenti elettronici, i relativi allegati A e B e la documentazione tecnica collegata.", "ref": "Fonte: Linee guida e documentazione tecnica per l'integrazione al sistema pagoPA", "fonte": "Linee guida e documentazione tecnica per l'integrazione al sistema pagoPA"}, {"id": 58, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Immodificabilit√† e hashing", "requisito": "La soluzione deve garantire l'immodificabilit√† del documento informatico tramite apposizione di firma elettronica/sigillo o tramite memorizzazione con registrazione nei log di sistema e calcolo dell'impronta crittografica (hash).", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 2.1.1", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 59, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Gestione metadati obbligatori", "requisito": "Il sistema deve associare permanentemente al documento informatico l'insieme minimo dei metadati previsti (All. 5), inclusi quelli di protocollo, classificazione e tempistiche di conservazione, fin dalla fase di formazione.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 2.1.1; par. 2.3.1", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 60, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Campi immodificabili del protocollo", "requisito": "Il modulo di Protocollo Informatico deve registrare in forma non modificabile: numero, data, mittente/destinatario, oggetto e impronta del documento (se trasmesso telematicamente), conformemente all'art. 53 del TUDA.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.2; nota 25", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 61, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Gestione annullamento protocollo", "requisito": "Il sistema deve gestire l'annullamento delle registrazioni di protocollo consentendo solo la procedura formale (art. 54 TUDA) che storicizza i dati, mantenendo visibili e comparabili le informazioni originali annullate e quelle modificate.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.3.1", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 62, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Classificazione e fascicolazione", "requisito": "Il sistema deve gestire obbligatoriamente il piano di classificazione e consentire l'organizzazione dei documenti in aggregazioni (fascicoli informatici e serie), collegando i fascicoli ai relativi procedimenti.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.4; par. 3.4.1", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 63, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Logging e tracciamento utenti", "requisito": "La soluzione deve garantire l'univoca identificazione degli utenti e il tracciamento permanente (log) di qualsiasi evento di modifica delle informazioni trattate e l'individuazione del suo autore.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.3.2", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 64, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Interoperabilit√† formati", "requisito": "Il software deve produrre e gestire documenti nei formati previsti dall'Allegato 2 delle Linee Guida (preferendo formati aperti e non proprietari), garantendo l'interoperabilit√†.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 2.1.1; par. 3.6", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 65, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Standard UNI 11386", "requisito": "Il sistema di conservazione (o il modulo di versamento) deve generare pacchetti di archiviazione conformi allo standard UNI 11386 per garantire l'interoperabilit√† tra sistemi.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.2; par. 4.8", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 66, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Conformit√† ISO 27001 e OAIS", "requisito": "Il sistema di conservazione deve aderire allo standard ISO 14721 (OAIS) e ISO/IEC 27001 per garantire autenticit√†, integrit√†, leggibilit√† e sicurezza degli oggetti digitali.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.4", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 67, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Produzione registro giornaliero", "requisito": "Il sistema di protocollo deve generare il registro giornaliero di protocollo e trasmetterlo entro la giornata lavorativa successiva al sistema di conservazione, garantendone l'immodificabilit√†.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.3.2", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 68, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Interoperabilit√† tra AOO (Messaggi)", "requisito": "Il sistema di protocollo deve supportare nativamente lo scambio di messaggi e documenti con altre Amministrazioni (AOO) rispettando il formato e le definizioni previste dall'Allegato 6 (\"Comunicazione tra AOO\").", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.2; All. 6", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 69, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Funzione \"registro di emergenza\"", "requisito": "Il sistema deve prevedere una specifica funzione di \"recupero dati\" che permetta di inserire a sistema, al ripristino dopo un guasto, le informazioni dei documenti protocollati manualmente sul registro di emergenza cartaceo durante il disservizio.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 3.5 punto 3.c; nota 35 (art. 63 TUDA),", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 70, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Segregazione logica (per Cloud/SaaS)", "requisito": "Se la soluzione √® erogata in modalit√† Cloud/SaaS, le componenti hardware e software e i dati dell'Amministrazione devono essere segregati logicamente rispetto a quelli di altri clienti del fornitore.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.11", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 71, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Tracciamento dello scarto", "requisito": "Il sistema di conservazione non deve limitarsi a cancellare i documenti scaduti, ma deve tracciare l'operazione di scarto, registrando gli estremi del provvedimento di autorizzazione (nulla osta) e mantenendo traccia dell'avvenuta distruzione.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.12", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 72, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Verifica integrit√† periodica", "requisito": "Il sistema deve disporre di funzionalit√† per effettuare (o permettere al Responsabile di effettuare) verifiche periodiche (max ogni 5 anni) sull'integrit√† e leggibilit√† dei documenti, rilevando eventuali degradi del sistema di memorizzazione.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.6 lett. f", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 73, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Accessibilit√† documentale", "requisito": "I documenti amministrativi prodotti dal sistema devono essere fruibili indipendentemente dalla condizione di disabilit√† personale, rispettando i requisiti tecnici della Legge 4/2004 (es. PDF accessibili/taggati).", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 2.3.1; nota 16,", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 74, "use_case": "", "section": "Protocollo informatico, gestione documentale, conservazione e firma", "subtopic": "Supporto alla localizzazione dati", "requisito": "Il fornitore del servizio di conservazione deve garantire l'accesso ai dati e alle descrizioni del sistema, assicurando che, sebbene i dati possano circolare in UE, le descrizioni del sistema siano disponibili.", "ref": "Fonte: Linee Guida AgID Documento Informatico, par. 4.11", "fonte": "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici"}, {"id": 75, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Sicurezza negli acquisti ICT", "requisito": "Per i contratti di beni e servizi informatici strategici, gli elementi di cybersicurezza costituiscono requisiti essenziali da soddisfare obbligatoriamente. Criteri di premialit√† devono essere previsti per le offerte che garantiscono l'uso di tecnologie provenienti dall'Italia, da Paesi UE, dalla NATO o da Paesi terzi firmatari di accordi di collaborazione strategica.", "ref": "Fonte: Decreto del Presidente del Consiglio dei ministri 30 aprile 2025, art. 1, c. 1", "fonte": "Decreto del Presidente del Consiglio dei ministri 30 aprile 2025"}, {"id": 76, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Programmazione acquisti", "requisito": "L'amministrazione deve aggiornare annualmente il programma triennale per gli acquisti di beni e servizi. I programmi sono approvati nel rispetto dei documenti programmatori e in coerenza con il bilancio e, per gli enti locali, secondo le norme della programmazione economico-finanziaria e i principi contabili.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 37", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 77, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Tempi della procedura", "requisito": "Le gare di appalto e di concessione si concludono entro termini massimi che vanno da 4 a 10 mesi a seconda della procedura e del criterio di aggiudicazione (minor prezzo o OEPV).", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), Allegato I.3, art. 1, c. 1, c. 2", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 78, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Programmazione acquisti", "requisito": "L'amministrazione deve adottare il programma triennale per gli acquisti di beni e servizi. In caso di ricorso a centrali di committenza, enti aggregatori o stazioni appaltanti qualificate, nonch√© tutti i casi di delega delle predette funzioni, l'adozione del programma triennale spetta all'amministrazione ricorrente o delegante.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), Allegato I.5, art. 6, c. 1, c. 1-bis", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 79, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Obbligo di qualificazione", "requisito": "La qualificazione delle stazioni appaltanti √® necessaria per gli affidamenti di lavori di importo pari o superiore a 500.000 euro e per l‚Äôacquisizione di servizi e forniture d‚Äôimporto pari o superiore alle soglie previste per gli affidamenti diretti. Non √® necessaria la qualificazione per l‚Äôeffettuazione di ordini a valere su strumenti di acquisto messi a disposizione dalle centrali di committenza e dai soggetti aggregatori.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), Allegato II.4, art. 2, c. 1", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 80, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Criterio di aggiudicazione (sopra soglia)", "requisito": "Fatte salve le eccezioni, le stazioni appaltanti procedono all'aggiudicazione degli appalti e all'affidamento dei concorsi di progettazione, dei contratti di servizi e forniture di importo pari o superiore a 140.000 euro caratterizzati da notevole contenuto tecnologico o che hanno un carattere innovativo e gli affidamenti in caso di dialogo competitivo e di partenariato per l'innovazione sulla base del criterio dell'offerta economicamente pi√π vantaggiosa (OEPV - miglior rapporto qualit√†/prezzo o costo). Pu√≤ essere utilizzato il criterio del minor prezzo per i servizi e le forniture con caratteristiche standardizzate o le cui condizioni sono definite dal mercato.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 108, c. 1", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 81, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Soglie europee", "requisito": "La soglia di rilevanza europea per gli appalti pubblici di forniture, servizi e concorsi di progettazione aggiudicati da autorit√† governative centrali √® 140.000 euro (o 143.000 euro dal 1¬∞ gennaio 2024). Verificare le soglie aggiornate al momento dell'avvio della procedura.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 14, c. 1, lett. b)", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 82, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Soglie europee", "requisito": "La soglia di rilevanza europea per gli appalti pubblici di forniture, servizi e concorsi di progettazione aggiudicati da stazioni appaltanti sub-centrali √® 215.000 euro (o 221.000 euro dal 1¬∞ gennaio 2024). Verificare le soglie aggiornate al momento dell'avvio della procedura.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 14, c. 1, lett. c)", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 83, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Digitalizzazione obbligatoria del processo di approvvigionamento", "requisito": "Le stazioni appaltanti (SA) e gli enti concedenti devono assicurare la digitalizzazione dell'intero ciclo di vita dei contratti, operando secondo i principi di neutralit√† tecnologica, trasparenza, protezione dei dati personali e sicurezza informatica.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 19, c. 1", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 84, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Piattaforme di acquisti", "requisito": "Le procedure di affidamento ed esecuzione devono essere gestite tramite piattaforme di approvvigionamento digitale (PAD) interconnesse e interoperabili con la Banca Dati Nazionale dei Contratti Pubblici (BDNCP). Le stazioni appaltanti e gli enti concedenti non dotati di una propria piattaforma di approvvigionamento digitale si avvalgono delle piattaforme messe a disposizione da altre stazioni appaltanti o enti concedenti, da centrali di committenza o da soggetti aggregatori, da regioni o province autonome, che a loro volta possono ricorrere a un gestore del sistema che garantisce il funzionamento e la sicurezza della piattaforma.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 25", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 85, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Rotazione e deroghe", "requisito": "Fatto salvo quanto previsto dai commi 4,5 e 6, gli affidamenti di contratti sotto soglia europea avvengono nel rispetto del principio di rotazione, ed √® vietato l‚Äôaffidamento o l‚Äôaggiudicazione al contraente uscente per commesse rientranti nello stesso settore merceologico/categoria.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 49", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 86, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Affidamento sotto soglia (servizi/forniture)", "requisito": "Per servizi e forniture (inclusi servizi di ingegneria e architettura e progettazione) di importo inferiore a 140.000 euro, si procede con affidamento diretto, anche senza consultazione di pi√π operatori economici, assicurando che siano scelti soggetti in possesso di documentate esperienze pregresse idonee all‚Äôesecuzione.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 50, c. 1, lett. b)", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 87, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Affidamento sotto soglia (servizi/forniture)", "requisito": "Per servizi e forniture (inclusi servizi di ingegneria e architettura e progettazione) di importo pari o superiore a 140.000 euro e fino alla soglia europea, si procede con procedura negoziata senza bando, previa consultazione di almeno cinque operatori economici.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 50, c. 1, lett. e)", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 88, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Criterio di aggiudicazione (sotto soglia)", "requisito": "Per gli affidamenti sotto soglia (ad eccezione dell'affidamento diretto ex art. 50, c. 1, lett. a e b e delle ipotesi di cui all'articolo 108, c. 2), le stazioni appaltanti procedono all'aggiudicazione sulla base del criterio dell'offerta economicamente pi√π vantaggiosa oppure del prezzo pi√π basso.", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 50, c. 4", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 89, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Programmazione acquisti (soglie)", "requisito": "L'amministrazione deve adottare il programma triennale per gli acquisti di beni e servizi per acquisti di importo stimato pari o superiore a 140.000 euro (soglia di cui all‚Äôart. 50, c. 1, lett. b). Per maggiori dettagli sulla programmazione si veda l'Allegato I.5", "ref": "Fonte: Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici), art. 37", "fonte": "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)"}, {"id": 90, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Interoperabilit√†", "requisito": "L'ente deve accreditarsi alla Piattaforma Digitale Nazionale Dati (PDND), sviluppare le interfacce e rendere disponibili le proprie basi dati senza nuovi o maggiori oneri per la finanza pubblica. Con la strategia nazionale dati sono identificate le tipologie, i limiti, le finalit√† e le modalit√† di messa a disposizione dei dati aggregati e anonimizzati di cui l'ente √® titolare.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 50-ter, c. 2, c. 4", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 91, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Interoperabilit√†", "requisito": "L'inadempimento dell'obbligo di rendere disponibili e accessibili le proprie basi dati ovvero i dati aggregati e anonimizzati costituisce mancato raggiungimento di uno specifico risultato e di un rilevante obiettivo da parte dei dirigenti responsabili delle strutture competenti e comporta la riduzione, non inferiore al 30%, della retribuzione di risultato e del trattamento accessorio collegato alla performance individuale dei dirigenti competenti, oltre al divieto di attribuire premi o incentivi nell'ambito delle medesime strutture.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 50-ter, c. 5", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 92, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Priorit√† Riuso/Open Source", "requisito": "Nell'acquisto di soluzioni digitali, l'ente deve effettuare una valutazione comparativa tecnico-economica che dia priorit√† al riutilizzo di software PA o al software libero/open source. Ove dalla valutazione emerga l'impossibilit√† - debitamente motivata - di accedere a tali soluzioni, √® consentita l'acquisizione di programmi proprietari mediante ricorso a licenza d'uso. Per ulteriori dettagli si indirizza l'ente alla consultazione delle linee guida aventi ad oggetti l'acaqusizione e il riuso di software all'interno della PA", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 68, c. 1, c. 1-ter", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 93, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Total Cost of Ownership", "requisito": "La valutazione comparativa deve essere basata su: \"Total Cost of Ownership\", che include: costo complessivo di acquisto, implementazione mantenimento e supporto; livello di utilizzo di formati di dati e interfacce di tipo aperto nonch√© di standard in grado di assicurare l'interoperabilit√† e la cooperazione applicativa tra i diversi sistemi informatici della pubblica amministrazione; garanzie del fornitore in materia di sicurezza, conformit√† alla normativa in materia di protezione dei dati personali e livelli di servizio.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 68, c. 1-bis", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 94, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Titolarit√† e Open Source", "requisito": "In caso di acquisizione di software sviluppato su specifica commissione, l'ente deve rilasciare il codice sorgente completo di documentazione in repertorio pubblico sotto licenza aperta, in uso gratuito ad altre pubbliche amministrazioni che intendano adattarli alle proprie esigenze (salvo motivate ragioni di ordine pubblico e consultazioni elettorali).", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 69, c. 1", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 95, "use_case": "", "section": "Requisiti trasversali", "subtopic": "Titolarit√† e Open Source", "requisito": "Per software sviluppato su specifica commissione, l'ente deve deve prevedere nei capitolati o nelle specifiche di progetto la titolarit√† di tutti i diritti sui programmi e i servizi, salvo che ci√≤ risulti eccessivamente oneroso per comprovate ragioni di carattere tecnico-economico.", "ref": "Fonte: Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale), art. 69, c. 2", "fonte": "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)"}, {"id": 96, "use_case": "", "section": "Requisiti trasversali", "subtopic": "API-first e interoperabilit√†", "requisito": "I servizi digitali devono essere progettati con un approccio API-first per garantire l'interoperabilit√† dei sistemi. Adottare il principio API-first per i servizi interni permette di riutilizzare le componenti e di integrarle pi√π facilmente con quelle delle altre organizzazioni in caso di necessit√†.", "ref": "Fonte: Linee Guida sull‚Äôinteroperabilit√† tecnica delle Pubbliche Amministrazioni, par. 3.2", "fonte": "Linee Guida sull'interoperabilit√† tecnica delle Pubbliche Amministrazioni"}, {"id": 97, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Cookie/tracciamento", "requisito": "Anche in assenza di consenso alla ricezione di cookie ovvero altri strumenti di tracciamento, ove possibile deve essere assicurata la piena fruibilit√† del sito web o del servizio digitale.", "ref": "Fonte: Linee Guida cookie e altri strumenti di tracciamento (GPDP 10 giugno 2021); par. 6.1 e 7.1", "fonte": "Linee Guida cookie e altri strumenti di tracciamento"}, {"id": 98, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Design e usabilit√†", "requisito": "I servizi digitali devono essere progettati prevedendo interfacce che si adattino al dispositivo dell'utente.", "ref": "Fonte: Linee Guida di design per i siti internet e i servizi digitali della PA, par. 5.5", "fonte": "Linee Guida di design per i siti internet e i servizi digitali della PA"}, {"id": 99, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Design e usabilit√†", "requisito": "I servizi digitali devono essere coerenti nello stile e nell‚Äôesperienza d‚Äôuso, privilegiando gli strumenti del Design System del Paese previsti su https://designers.italia.it", "ref": "Fonte: Linee Guida di design per i siti internet e i servizi digitali della PA, par. 5.5", "fonte": "Linee Guida di design per i siti internet e i servizi digitali della PA"}, {"id": 100, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Accessibilit√† Legge n. 4/2004", "requisito": "La piena accessibilit√† deve essere garantita conformemente alla Legge 9 gennaio 2004, n.4 e alla norma tecnica UNI CEI EN 301549.", "ref": "Fonte: Linee Guida sull‚Äôaccessibilit√† degli strumenti informatici, Cap. 2.2", "fonte": "Linee Guida sull'accessibilit√† degli strumenti informatici"}, {"id": 101, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Accessibilit√† Legge n. 4/2004", "requisito": "La PA deve pubblicare la dichiarazione di accessibilit√†.", "ref": "Fonte: Linee Guida sull‚Äôaccessibilit√† degli strumenti informatici, Cap. 4.1", "fonte": "Linee Guida sull'accessibilit√† degli strumenti informatici"}, {"id": 102, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Accessibilit√† Legge n. 4/2004", "requisito": "La PA deve pubblicare gli obiettivi annuali di accessibilit√†.", "ref": "Fonte: Linee Guida sull‚Äôaccessibilit√† degli strumenti informatici, Cap. 4.2", "fonte": "Linee Guida sull'accessibilit√† degli strumenti informatici"}, {"id": 103, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Trasparenza e feedback", "requisito": "Il sito deve consentire agli utenti di comunicare facilmente all‚Äôamministrazione feedback e segnalazioni di difficolt√†/insoddisfazione.", "ref": "Fonte: Linee Guida sull‚Äôaccessibilit√† degli strumenti informatici, Cap. 7.3", "fonte": "Linee Guida sull'accessibilit√† degli strumenti informatici"}, {"id": 104, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Trasparenza e feedback", "requisito": "L'amministrazione deve effettuare la raccolta e la valutazione di tali feedback.", "ref": "Fonte: Linee Guida sull‚Äôaccessibilit√† degli strumenti informatici, Cap. 7.3", "fonte": "Linee Guida sull'accessibilit√† degli strumenti informatici"}, {"id": 105, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Cookie/tracciamento", "requisito": "Il titolare del trattamento adotta misure appropriate per fornire all'interessato tutte le informazioni di cui agli articoli 13 e 14 e le comunicazioni di cui agli articoli da 15 a 22 e all'articolo 34 relative al trattamento in forma concisa, trasparente, intelligibile e facilmente accessibile, con un linguaggio semplice e chiaro, in particolare nel caso di informazioni destinate specificamente ai minori.", "ref": "Fonte: Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati), art. 12", "fonte": "Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati)"}, {"id": 106, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Cookie/tracciamento", "requisito": "In caso di raccolta presso l'interessato di dati che lo riguardano, il titolare del trattamento fornisce all'interessato, nel momento in cui i dati personali sono ottenuti, le seguenti informazioni:\na) l'identit√† e i dati di contatto del titolare del trattamento e, ove applicabile, del suo rappresentante;\nb) i dati di contatto del responsabile della protezione dei dati, ove applicabile;\nc) le finalit√† del trattamento cui sono destinati i dati personali nonch√© la base giuridica del trattamento;\nd) qualora il trattamento si basi sull'articolo 6, paragrafo 1, lettera f), i legittimi interessi perseguiti dal titolare del trattamento o da terzi;\ne) gli eventuali destinatari o le eventuali categorie di destinatari dei dati personali;\nf) ove applicabile, l'intenzione del titolare del trattamento di trasferire dati personali a un paese terzo o a un'organizzazione internazionale e l'esistenza o l'assenza di una decisione di adeguatezza della Commissione o, nel caso dei trasferimenti di cui all'articolo 46 o 47, o all'articolo 49, paragrafo 1, secondo comma, il riferimento alle garanzie appropriate o opportune e i mezzi per ottenere una copia di tali garanzie o il luogo dove sono state rese disponibili.", "ref": "Fonte: Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati), art. 13", "fonte": "Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati)"}, {"id": 107, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Privacy by design e RPD", "requisito": "Il sito web deve garantire la protezione dei dati personali fin dalla progettazione.", "ref": "Fonte: Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati), art. 25", "fonte": "Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati)"}, {"id": 108, "use_case": "", "section": "Siti web istituzionali e portali tematici", "subtopic": "Privacy by design e RPD", "requisito": "Il nominativo e i contatti del Responsabile della Protezione dei Dati (RPD) devono essere pubblicati sul sito web e comunicati all'autorit√† di controllo (Garante Privacy), pena sanzione pecuniaria.", "ref": "Fonte: Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati), art. 37, par.7", "fonte": "Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati)"}]
;

const SECTION_ICONS = {"Requisiti trasversali": "‚öñÔ∏è", "Acquisizione e riuso software": "üîÑ", "Cloud qualificato/hosting": "‚òÅÔ∏è", "Comunicazione digitale": "üì°", "Cybersecurity": "üõ°Ô∏è", "Identit√† digitale (SPID/CIE/SSO)": "ü™™", "Intelligenza Artificiale (IA)": "ü§ñ", "IoT / Smart Land / Data Platform urbana": "üåê", "Pagamenti digitali": "üí≥", "Protocollo informatico, gestione documentale, conservazione e firma": "üìã", "Siti web istituzionali e portali tematici": "üåç"};
const SECTION_SHORT = {"Requisiti trasversali": "Trasversali", "Acquisizione e riuso software": "Riuso SW", "Cloud qualificato/hosting": "Cloud", "Comunicazione digitale": "Comunicazione", "Cybersecurity": "Cybersecurity", "Identit√† digitale (SPID/CIE/SSO)": "Identit√† Digitale", "Intelligenza Artificiale (IA)": "IA", "IoT / Smart Land / Data Platform urbana": "IoT / Smart Land", "Pagamenti digitali": "Pagamenti", "Protocollo informatico, gestione documentale, conservazione e firma": "Protocollo", "Siti web istituzionali e portali tematici": "Siti Web"};
const SECTION_COLORS = {"Requisiti trasversali": "#2563EB", "Acquisizione e riuso software": "#7C3AED", "Cloud qualificato/hosting": "#0891B2", "Comunicazione digitale": "#059669", "Cybersecurity": "#DC2626", "Identit√† digitale (SPID/CIE/SSO)": "#D97706", "Intelligenza Artificiale (IA)": "#7C3AED", "IoT / Smart Land / Data Platform urbana": "#0D9488", "Pagamenti digitali": "#2563EB", "Protocollo informatico, gestione documentale, conservazione e firma": "#64748B", "Siti web istituzionali e portali tematici": "#E11D48"};

const FONTE_URLS = {
  "Circolare 18 aprile 2017, n. 2/2017 (Misure minime di sicurezza ICT per le pubbliche amministrazioni)": "https://cert-agid.gov.it/download/CircolareAgID_170418_n_2_2017_Mis_minime_sicurezza_ICT_PA-GU-103-050517-2.pdf",
  "Decreto del Presidente del Consiglio dei ministri 30 aprile 2025": "https://www.gazzettaufficiale.it/eli/id/2025/05/05/25A02717/sg",
  "Decreto legislativo 31 marzo 2023, n. 36 (Codice dei contratti pubblici)": "https://www.normattiva.it/uri-res/N2Ls?urn:nir:stato:decreto.legislativo:2023;036",
  "Decreto legislativo 7 marzo 2005, n. 82 (Codice dell'amministrazione digitale)": "https://www.normattiva.it/uri-res/N2Ls?urn:nir:stato:decreto.legislativo:2005-03-07;82",
  "Decreto-legge 16 luglio 2020, n. 76 (Misure urgenti per la semplificazione e l'innovazione digitale)": "https://www.normattiva.it/uri-res/N2Ls?urn:nir:stato:decreto.legge:2020;76~art55",
  "Direttiva (UE) 2019/1024 del Parlamento europeo e del Consiglio relativa all'apertura dei dati e al riutilizzo dell'informazione del settore pubblico": "https://eur-lex.europa.eu/legal-content/IT/TXT/?uri=CELEX%3A32019L1024",
  "Legge 23 settembre 2025, n.132 (Disposizioni e deleghe al Governo in materia di intelligenza artificiale)": "https://www.normattiva.it/uri-res/N2Ls?urn:nir:stato:legge:2025-09-23;132",
  "Linee Guida acquisizione e riuso software PA": "https://www.agid.gov.it/it/design-servizi/riuso-open-source/linee-guida-acquisizione-riuso-software-pa",
  "Linee Guida cookie e altri strumenti di tracciamento": "https://www.garanteprivacy.it/home/docweb/-/docweb-display/docweb/9677876",
  "Linee Guida di design per i siti internet e i servizi digitali della PA": "https://docs.italia.it/italia/design/lg-design-servizi-web/it/versione-corrente/index.html",
  "Linee Guida per l'adozione di un ciclo di sviluppo software sicuro": "https://www.agid.gov.it/sites/default/files/repository_files/allegato_1-_linee_guida_per_ladozione_di_un_ciclo_di_sviluppo_di_software_sicuro.pdf",
  "Linee Guida recanti regole tecniche per la definizione e l'aggiornamento del contenuto del Repertorio Nazionale dei Dati Territoriali": "https://geodati.gov.it/geoportale/images/struttura/documenti/LG-RNDT_v.2.0.pdf",
  "Linee Guida sull'accessibilit√† degli strumenti informatici": "https://www.agid.gov.it/sites/agid/files/2024-06/Linee%20Guida%20sull%27accessibilit%C3%A0%20degli%20strumenti%20informatici%20-%20PA.pdf",
  "Linee Guida sull'interoperabilit√† tecnica delle Pubbliche Amministrazioni": "https://www.agid.gov.it/sites/agid/files/2024-05/linee_guida_interoperabilit_tecnica_pa.pdf",
  "Linee Guida sulla formazione, gestione e conservazione dei documenti informatici": "https://www.agid.gov.it/sites/agid/files/2024-05/linee_guida_sul_documento_informatico.pdf",
  "Linee guida e documentazione tecnica per l'integrazione al sistema pagoPA": "https://www.agid.gov.it/it/piattaforme/pagopa/linee-guida-documentazione-tecnica",
  "Regolamento (UE) 2016/679 (Regolamento generale sulla protezione dei dati)": "https://www.garanteprivacy.it/documents/10160/0/Regolamento+UE+2016+679.+Arricchito+con+riferimenti+ai+Considerando+Aggiornato+alle+rettifiche+pubblicate+sulla+Gazzetta+Ufficiale++dell%27Unione+europea+127+del+23+maggio+2018",
  "Regolamento (UE) 2024/1689 (regolamento sull'intelligenza artificiale)": "https://eur-lex.europa.eu/legal-content/IT/TXT/PDF/?uri=OJ:L_202401689",
  "Regolamento per le Infrastrutture Digitali e per i Servizi Cloud per le Pubbliche Amministrazioni": "https://www.acn.gov.it/portale/documents/d/guest/regolamentocloud",
  "SPID OpenID Connect Federation (Regole tecniche per il funzionamento della Federazione SPID OpenID Connect)": "https://www.agid.gov.it/sites/default/files/repository_files/spid-oidc-federation.pdf"
};

const SECTION_ORDER = [
  'Requisiti trasversali',
  'Acquisizione e riuso software',
  'Cloud qualificato/hosting',
  'Comunicazione digitale',
  'Cybersecurity',
  'Identit√† digitale (SPID/CIE/SSO)',
  'Intelligenza Artificiale (IA)',
  'IoT / Smart Land / Data Platform urbana',
  'Pagamenti digitali',
  'Protocollo informatico, gestione documentale, conservazione e firma',
  'Siti web istituzionali e portali tematici'
];

let checkedItems = new Set();
let naItems = new Set();
let activeSection = null;
let searchQuery = '';
let showOnlyChecked = false;
let showOnlyUnchecked = false;
let showOnlyNA = false;
let collapsedSections = new Set();

function saveState() {
  // Debounced save to Supabase
  if (!currentCompId || !sbClient) return;
  clearTimeout(_saveTimeout);
  _saveTimeout = setTimeout(async () => {
    try {
      await sbClient.from('compilazioni').update({
        checked_items: [...checkedItems],
        na_items: [...naItems],
        updated_at: new Date().toISOString()
      }).eq('id', currentCompId);
    } catch(e) { console.error('Errore salvataggio:', e); }
  }, 500);
}

function getFilteredData() {
  let filtered = DATA;
  if (activeSection) {
    filtered = filtered.filter(d => d.section === activeSection);
  }
  if (searchQuery) {
    const q = searchQuery.toLowerCase();
    filtered = filtered.filter(d =>
      d.requisito.toLowerCase().includes(q) ||
      d.subtopic.toLowerCase().includes(q) ||
      d.ref.toLowerCase().includes(q) ||
      d.section.toLowerCase().includes(q)
    );
  }
  if (showOnlyChecked) {
    filtered = filtered.filter(d => checkedItems.has(d.id));
  }
  if (showOnlyUnchecked) {
    filtered = filtered.filter(d => !checkedItems.has(d.id) && !naItems.has(d.id));
  }
  if (showOnlyNA) {
    filtered = filtered.filter(d => naItems.has(d.id));
  }
  return filtered;
}

function groupBySection(data) {
  const groups = {};
  for (const item of data) {
    if (!groups[item.section]) groups[item.section] = [];
    groups[item.section].push(item);
  }
  return groups;
}

function renderSidebar() {
  const sectionCounts = {};
  for (const item of DATA) {
    sectionCounts[item.section] = (sectionCounts[item.section] || 0) + 1;
  }

  let html = `
    <div class="sidebar-header">
      <div class="sidebar-logo">Check<span>ICT</span></div>
      <div class="sidebar-sub">Requisiti Acquisti PA</div>
    </div>
    <div class="sidebar-section-title">Sezioni</div>
    <div class="sidebar-item ${!activeSection ? 'active' : ''}" onclick="setSection(null)">
      <span class="icon">üìã</span>
      <span>Tutti i requisiti</span>
      <span class="badge">${DATA.length}</span>
    </div>
  `;

  for (const sec of SECTION_ORDER) {
    const count = sectionCounts[sec] || 0;
    const isActive = activeSection === sec;
    const icon = SECTION_ICONS[sec] || 'üìå';
    const short = SECTION_SHORT[sec] || sec;
    html += `
      <div class="sidebar-item ${isActive ? 'active' : ''}" onclick="setSection('${sec.replace(/'/g, "\\'")}')">
        <span class="icon">${icon}</span>
        <span>${short}</span>
        <span class="badge">${count}</span>
      </div>
    `;
  }

  // Progress at bottom
  const total = DATA.length;
  const done = checkedItems.size;
  const na = naItems.size;
  const applicable = total - na;
  const pct = applicable > 0 ? Math.round((done / applicable) * 100) : 0;

  html += `
    <div class="sidebar-progress">
      <div class="progress-label">
        <span>Completamento</span>
        <span>${pct}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: ${pct}%"></div>
      </div>
      <div class="progress-stats">
        <div class="stat-mini">
          <div class="stat-mini-val" style="color: var(--success)">${done}</div>
          <div class="stat-mini-label">Completati</div>
        </div>
        <div class="stat-mini">
          <div class="stat-mini-val" style="color: var(--warning)">${na}</div>
          <div class="stat-mini-label">N/A</div>
        </div>
        <div class="stat-mini">
          <div class="stat-mini-val">${applicable - done}</div>
          <div class="stat-mini-label">Rimanenti</div>
        </div>
      </div>
    </div>
    <div class="sidebar-institutional">
      <div class="sidebar-inst-label">Progetto realizzato nell'ambito del</div>
      <img src="data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCABJAosDASIAAhEBAxEB/8QAHAABAAICAwEAAAAAAAAAAAAAAAUGBAcBAwgC/8QARBAAAQMDAwIEAwIKBwgDAAAAAQIDBAAFEQYSIQcxExRBUQgiYRVxFhcYI0JVgZGT0iQyUlZ0lMElJjNFkqOx0UNkof/EABkBAQADAQEAAAAAAAAAAAAAAAABAgMEBf/EACoRAAICAQMDAwMFAQAAAAAAAAABAhEDEiExBEFRBRNhIlLRFTKxwfBx/9oADAMBAAIRAxEAPwD2XSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBTincVrXq/1IiaUty2be8iRcUOAPNoIKmUgAnOeASCAM++fSqTmoK2ErL/KlxIq2UypTDCnnA20HHAkuLPZKQe5PsOa5dmRGpLcZ2Uy3IdBLbSnAFrA7kAnJH3VozTMBU7UkHXmsbi5Mnu5eYhMLITCH6KADjAwRwMZwSSc1O61h6c10IZuaXoFwaJS3NYXt8IZyM98gHn0xzg81n7jabotpdWbgyKV520D1Nv2ndYJ03rK7tz7b4i2DPdTsLSxkpUVEAqQQMAkdznJr0Gy4h5tLjagtCgFJUk5BB5BB9RV4ZFNbFEzupSul91DKQVbjk4ASkkk/QCtCTupUfLuDDMQvBRVxkDkEenPqOePfPFcWtE1QXJmOK3u4KWQAEtD0Hvn35pW25FkjSlfK1JQkqUQEgZJJwAKEn1SldSnGw8lsrTvUCQknkgYyQPpkfvoDtpSsebKYhRHZct5DLDSCtxajgJAGSTQGRSo2wzZFwg+deirjJdUSy24fn8P9EqHoSOcegIzzmpKjApSlAKUpQClKUApSlAKUpQClKUApSmQKAUrjIz3rmgFKZpQClKUApSlAKUpQClKUApSlAKUpQClKUArgmua4PegPOGpPiDvtq1DcrW3Y7c4iHLdYStSl5UELKQTg9yBWB+UnqH+79s/61/+61xeo7Mvq9NiyEb2Xr8ttxOSMpMggjI57E16i/Ez03OP93E5/wAS7/PXFF5Jt0+DzoPLkb0yNV2/4k7oJbf2hp6GqMThwMOqSsD1IJJGfof3it6uausrehvwx8cm2eVEneB8xB7Jx/aycY9+K8yfEnpSxaT1LbYlhgiGw9D8RaQ4pWVb1DOVEnsBWxosCbc/hLZhW6I/LkusDw2WUFS1Yl5OAOTgAnj0Bq8JzTae7RfHkmnKMnbSK9O+JO7mU55LT0JMfJ2B1xalY+pBAz9wqd1d1yu9osmnZ7FlhLXdIZkuJWtZCCFqRgYI4+XPOe/0rRv4Aa3/ALo3v/Iu/wDqrr1D0bqyTpbRjMfTd0ecjWxbbyG4i1FtRdUQFAAkHBzg+9ZRyTadmUcuVptmyelXXRGptRs2O9WxqC/KOyO8yslBX6JIPIz2BBPOBjnNXLq51ItugLayp5hUy4Sc+WipVtyB3Uo4OEgkDsST27Ejzd040RrCLr6wyZOl7wyw1cGFuOLhrSlCQsEkkgAAAE5NT3xbrUepcRBUopFraIBPAy47nFaRyT0Nvk0jmmsVvkkz8Sd/ydun7aB6fOvP/mn5SWof7v2v/rX/AO6ufSzpXoS89PrLdLjYUvy5MULdc8w6NxJPOAoAfsFWf8S/TfPOnE4/xLv81So5Wk7JUc7SalydXRLqO51Ct09cm3phyoK0BYbUVIWlYJBGeQflII59DnnAifxqXVu1Pz3YNof/AKLKfaYjyVKcY8FYT+eBHyhQPBHrgc5rYeltMWPS9vVCsVubhMLVvXsUSVHtkkkk8e549K1sxLsKdIu2s6bkx7HdmZfl5iZCPMSfD3vELwnKdwQspJJ4ABwTWr1JU3ubfVGKTe5Nwdd3iY/9lRY1ml3B2ciKxKjSVrhkFlTqyTjJUgIIKR6qTyOa7Gdb3mW4i3tRrVEuEYS1XJ2Q8vy7SI60oKkEAEhRWCM4wAc59avcrvBbYL7limWm4S5MO4xEx7k0lDankKZDoWUFKMgELCgQQc881zdHGYDMdpi3XBqXGt8i4zJka8Mla2XnT4oK1IKHSothWABjAAIqtvyNb8k/ceodxjXx2G23ZJDLJhANolL8xLL4SSWE4IUBnI9wOcVkyNe3BqVfibfF8rEiTXre4XTufXFIS6FjGANyuCM8A1CxmbCL/wDZNvss11YRFVDmOSEpPmY0dDrTIJSSglojcTkHJGOajocC0PW6Op3SMiI7Kkzbcl1m4IW9JWUPh4OKCeQVIOD7lJ9MGbl5I1PyWNjqROdf06wLUwHZ6XBcElw/0VaSsBI98ltff0FYsHqlcpFjsUkWeOJ0+clmWz4pKWGSpADgOMkkOtEZ4ySPSsaVI0y27FnQrPNfkXBmJc2w3ICSp9wGOy0cjAyFuEngZQTgnipXSGm7HcFS4T9rk265Www4ryPNBzKGQhxlYWAAQoBOTgE7cEcZqE5N7MJzb2ZMad1ZMuOrZdqkRGGYSjIEF5LhK3THcS27uGMD5lcYPYH2q55FVSz6F09arjDuMGOtuZEU6S/uG98uA7/EOPmyTn05ANWr07VrG63N4p1uc0pSrFhSlKAUpSgFKUoBSlKA6Jrwjw35ChkNNqWR9wJ/0rxxa/Nai1TbJbqkvPTZbtznKVkgICsJBBHuDgcjke1eudVy27fpe7T3WS83GhPPKbBwVhKCSAfTIGM157uFysWktL2u7QJMWWZshDBQRtUY7YAyAMkYBGR7k1z5YptWTFLuXhi52Vu1PyGJ0WRLU2opBUCVLIwAB9+BxXzaIcPTzMmyXmW2ChSXm1vKAWoLAUcH6K3JH3VJ6dYi2bUMKNADSIM3xH3ozyAQwAgqLqT3RzgEHgk+h5qR1beYd1h282idGMaXIVFemNoC1tkJJCASPlJIIBI9QR3Bp8vsdyS/alszzr15h3GfKRMtpVMsqI5ZU8wpOW3QvcCrjOOwJP3cVvX4Xr49euksASXFOPQXFxFKURnCTkDj0AIA+6qlqKTa7Dq6z6UWzFhWafEfVIeUrK8oSVYCfUkA49SSMVMfC5e3JtlvVmZt7MeBa5YRFeQkhcgLKjvWO2SAnsPvqIKp88nFkjFSel7G51EhJIGSBnAqLXIlvx2VNRdstB3FKydiTgggqwMnB9B3qWrHXLZS54e/K8/1Ugk//ldKKmv7xLvcVNwurkVcWLHlpS0XkhTjh4C3UNg/Mc8ISeMkk5qRtI1m74b0x1TDLoL3gFsKcTn+q0VcAYAyTySTgYAxU43HiyLshyU63IfZcJaTyQhXPPsCBnA9OfWprmtXkpVRVR+SmwnNa+Oy9KbaCVrW84wgAlCThKGic4JH9YkHjsPeuuQjV62GfLIIAbW48iUUr3qBISggDATzuOOTgDjmrvSq+58CvkqVtlXW1NT7lqCUsxUbW2GylO5ZGBkAfpLUcBI4HAHqai24Wskz37snyyJcho5CwVpYSThDYA5OwZUcd1YHYc22Vam5d3jXCQ444mKCWWD/AMNLh/8AkI9VAcDPAySOTms951toArWE57Z7mnuV2JorqY2olXC2pMoqYaK3H1qASVnGAkgZAByTgdsY+7C1tbL5d7jHbjoR9nxlIcCTghbhJ+dSTwoIABCTwSQTwMVYJF+tMd4NPTEtuHkBSVD/AErPjutvtJdbVuQoZBwRkftqNTTuiKT2IfSbd4TFdevLqi664VNtKIJaR2CSQBk4GSfUk+gFTvpSlVbt2SlQpSlCRSlKAUpSgFKUoBSlKAUpQ9qApHU7X1p0TbSp9fi3N9BMOKkE7z2BURwEg8kkgkAgZPFa60pI17rZdtv18v7tpt6HQsRIAKXHQk5yQOCCeMkkcZwRyYDqzZp2qOt02AlxtEaIy26484obWmghIz375KyB2yDnHetz6Xjrh2RVihW9MN1lkspU+586gBgLwByOQeD644JrnjJyk/CPOhhy9Vmbk6jHhFZ6hwbreZDeotM6judsuEZkhuMHcxnikk4wDjccjIIKTtAIHJrp6YdWHrndl6d1i1Htt03hphSUqQHF8AoUDkJVnscgHIAAOM3x+OizQX2ERWXYi3MsshW0klIykDBycgkY5/dXm/rNpuVAvq7uEqLUtwF5h0grjrIyErPbBAJB+mPqbTk4/UjH1HFm6aSz4N03uvg9PahnvwYaFxmg6+64ENpIUrJwSeEgk8A9hx3PANVNOoJqPz8q7ymoCZCmFzCy0lCyASoJGwkBOCMkY4OcFJzI6l1Ha7R05TqS/wAVFyjNssKebjJQ8FrWUoyjcQkjK++RxmscaytIlS4d0sFyt1wgwHZiIUpllTjrAHz+EpC1oVwACAsYyAQK7Mabjek9PWmkZUXXWny2y2bj4ysoQ45tCCCcjJQSFDlPOBxkcYzj6tmuLJLZU868tkeMtpA8Nat2M4yQCATgnbkkcA4OQPm2HQ67cxcxAstu8601JUiQyy24PFAKN4H6R2gdzko4JxXdf4NgDabagWGHNlpKGUSGWyVg4yAg4KhlKCQO+0DIIBE1C6pkpuuTui6v07Kuy7TGuHiywtKdqWXNpKgSnCtu0ghJIIJGAfasSXryxR7s3BMtC2yha3XhkhG0gYCQCVA5BJHABBJ+ZIOPGRonRdiUpx+2I+yWVrccw2Xk7BlQAHII3gBI7BQA7iuiBfNIXa4wk2u32ObClxXJMmUl6OFRk7QQFtk7zkEgnGBjmihG7p0NXZslrrcbgmFDktR0pXLV4bTKn1JCCQVBa1JGThCSSkY5yASSCOmDqmNF863dpIQmMAoEJLqikgqySgEYxjAPzYBJzkEyki7adeivB+5WlcZlKFvBb7ZQ2FYKCrJwAeCCe/GKSTp2D5cPm2Rg5sbjhexG7B3ISjOM4OCAOx5FUVcNEt/JHq1zpsOhsT95KgCAggpBJAJScHGU9wD3B7EV1RNd2KVObQzI8SM41vS8EqznkkFGMgYB59woYyDjFv2ntGvP+Qc+xLcl2SjzTLaGW3H1nBCCcA5WAAR3IBHOQRk2K5aJlaouNktjVsTdbWpHjIbZQlQJGcpIGTjOCR2JwcGrqMNNpMq5NOrMjUGsLVaZbMNTviPreShwbVgIBwSchJ3EAjCQCSSM4AJGZGuqLnbo8u3BS2X1FSSFoCnGh+mkE4wTt5OCArOAcUjN6avLj0mKi1XFQUUPONht0hWBkKIzzgDg+wqL1zf7HpbT7q1R4chURDSU29C0IUGluobBCMHCQSD2wcYqiinSityXKlbZEydYTGZEuI040W0Phhh8gHOfmJG4jecKbQjBIKiMk5AqTg6xs0O3gyrxImHesb32UtOcAk5AShJAx3AxgpOSDmpd5nThuKYL6bYZzv51MdewuKwSrcEnk4JJyB3yao9u1Jpe93SzQntHQVKmXOZCZW6y2rwTEGAsAo9QkAAYwAOeK1UVNbRIcqfJcLZq+zXJ1tiGt9x5x3w0tlooJGSN+TgbSBuBzkgp4yoA2P0qFtX4POyFM2w2tb8MkKTH2FbBIwchPKSQAD2zj6VNVzyq6SLq+4rg965rg96gk8M3qQzE6vzZUhexlm/LccVgnCRIJJwPoDXqRPWbpwEj/eJGR/8AXd/lrypquGu49T7rAbWlC5N5eZClZwCp8gE49Oa2YPhu1IRn7dtX/c/lrhxymm9Ks8zDLIm9KIT4k9VWLVmpbbLsM5MxlmH4a1BCk4VvUcYIB7EVsSPNmW74SG5cCS9FkttDY604UrTmWAcEYIyCRx71X7Z8Nt2VMb+0dQQ0RgQXCw2tSyPUAEAA/U/uNb3XpOyq0QdHmMRa/LeWCN3zAY4Vn+1nnPvzWkITbbaq0a48U25SkqbR4t/DXWH96b3/AJ93+arv1F1XqZjSui3Y+obq049a1qdU3LWkuKDqgCoggk4AGTntVnn/AA2XHzbnkNSRVRySW/GZUFgegOCRn6j9wqd1b0Nud4smnrexfYjarVDMdxS2lYWSsryMenOOfb61msWRJoyjhypNM1J021dqqT1AsEeRqS7vMuXBhC0OTHFJUCsAggkgggkYNWT4t0KHUqIsggG1tAEjg4cdzWxOlfQ1jS2oWL5ebki4SIx3R2WmyltC/RZJOSR3AwMHB5xVt6udN7Z1At7KXn1Q7hGyI8pKd2Ae6VDIyM89wQe3cg3jinoafJpHDP2mnyVXpZ1S0LZ+n1ltdyvqWJUeKlDrZYcO0gnjISQf2VZvxz9OPXUaMf4d3+WtRL+G7UQPy361kZ4JDgP7tprj8m3Un69tP/c/lqVLKklRKlmSS08HoXSuprHqmAqZYri1NYSrYsoBBQcZwQQCOPcc1rKJGg/YS5bjt8XpyEJDVo/o7OVuPFTACcL3rOXVBG4JGDkngVYeiPTl3p7bZ6JFwRMlzloLnhpIbQEAgAZ5J+Y5OB6ccc5Lejbw3pxWnjdofkorqX7e95ZReQtDwdbDg34UARg4AJHsa1qTSbW50NOSTZT7snSVt03DsybbMscxi7w2JB8o06vxUtlbbjo3FK2ykKJwTjngc1xf29NXCddYlybn3K42uPGtiHI0FptPiuvktrZBVgFKyEkHA+U98mrdJ0DJusxVwvc+O5IflFyQ2wyQ2GxFdYShGSTkF0rJPcjGBWN+LEqimO7enXS6iJ5l7YUOurZkrfcXuSQQVleAQcjAOTVXF+CjjJ9iP05Dslx1XGw9eWL6m4ybg+l9eEtrb8NC2i2FlABQ8gBQBJA7jtXLU+2sWxVxMC9fZ2n7rPnGVsZIfcDryVtgBecblqAJAztGcZqxvaMft94t1w0xIiQzGaktvIltuPl8vLaUpZXvCir80OST3+lRjPT2ei3X23iZakt3VUlfmUQlCQC66XAFL34IBOMYHYVNPsidL4orMZWmoMeJCRcbw47eGk3G3vCOj/Z6I3iPttKBOCQQ6MHOcEZHep6x6njacsT+p71CvLrl3kMKXIWy0kugtYQUNoWdqEoRkgknknn0znem6fOuSWboobpT7raVNZ8FpyO80Gk4PYLfWvP1xj1padAyo9ot1slv2gR4Mph8+UhKbMgIbUhQcys5Kgocj68c1CUlwglNPZEjc9eRohdMezXOchm4CAtbAbwHVbNgGVjIUXEgH784rvZ1pBVf1WZ6HNYfQwXFqWlJQHA2l1TOQTlYQoE44788VGWHQci3WFVseuyZKjeGJ6XVMkHw2lNlKCM8na0Bn65xRWgX/tb7VF9kmQq5vTS0pILOxxtTRQE9wQgpGc4yO3NX+svc/By31KtqrSbi/Z7rGSuEidHQtCCZDK1pQCkhZAOVoyCQcEVbLLOkXGIp6TbJVuWFlIakFBVgAcgoURg5I754Na/a6VNxtPv2yHPaSqRao0N5brSnAXWVhRWAVZSheCCgEDgEdqvOlLdKtdqESUm3IKVkoTAjlloJPONpJOckknPrUrV3EXK/qJmlKVc1FKUoBSlKAUpSgMeSw1KjPRn0BbTyC24k9lJIIIP3gmvK9+6dybTri32a6q32tE0IivLUSFsLOQcfQ4Sr2wD2NepLiuS1b5LkRsPSEtKLSCcBSgDgE+mTgZryvprUCY+pLvH6hPXae1MaQ2Uvk+PBWlZIKEHkAleOBxx3Fc2eSTSZ2dJ0U+ojJx3a7d2bIlW8v31D92kv+XbbLBaSCEOgKBIV6kZA47cciuzUsKFcXWXbbIcYlBxBUGU/K6EHKQodjjsD3Hoa11+M7UsPU/iy2H7vZYqiG2rgyhLjjAITvBTyFnKScggnk4rpvXWWW8wYGnbFGtU2M6ta5Snw8S2R8oQcAFROOSCBjgetZ+9jpnpR9N6x1S2o++tulU327WmaFSXrshlbgaZyVFAOE8AH1B5A7Hk1vDoTpR/SXT+LFnICLhLWqVJSAQUFfIQfqlOAfqDWj52tY1w0PdPOme/rC4xxElSn0JaRBaBJ+VSe+dueBycZwBzt74dfwmOj3BqB2bJZLoVDkTVqU86kpG4/NzsBzgnBIJ4xirYpKU7W+xx9T6fPFjeSezuqff5NnrBKSEnBIOD7VTZdymzbiuwwB5aPEwLhLSrlaiM+E3gE5IwVH9EEDueLi4tLaSpRCUgZJJwMffVeiOWaI5I8C7QEoffU85h5O4lRyRnPAJ9e9dkWlyeVKUVy6MyGu2wmykzYyRHQMpCglDQIGMjPBII5Jyc/WspVzhJeZb8wk+MlS0kdsJGSSfTj39qrCLPpMRGI6rlEdSw+X0+I+lQUskklQzhRyQcnPIHtivmbaNMzWymZfG3kALQ0kyEBLYWQVDAIBJA25PpxUtwb5K+7HyizRbrCkkeHJYIUAtspdB3oIyF8dgecZ74NfSbpbSkuCdHKQgOFXiDASTgEnPbPH31WDadLCDLiIvLTSZLpWtaJKAsZwMA+mEjaP7I7YPNZDOktPuluQwGVtBTamUhQU2lKAQhIGcEDJIzkZOcE81NQfcmM1LhotbLrb7SXWlhaFDIUDwahdTXE2aFIuBSlS1bW2UjJWtZ4S2kepKjx6ckntWb5ZLSY4ivhpLBP5vd8q8jHzY9u/wB9Y0m1R5klMme+X3WgrwMHaGCQQVJGf62CRuPI9Mc1CpPcu7o64E+JDtPj3Ce0483tTJWlYUErJxtGM8AnH7Dms12725pyU29MZaMXYXitYAQFEhOSfcjH38VFo0taEQY0IJQllhxCkoQAkHbyAR688knJJ5rHn2LTzUsPzpjaFLlCSUuupAWpIwkYJ5CfT2PPfmpehu2wlKWyR9ytT7r81aYSWdzKkquLzqx4cYHO1sEH5nVY4A7DJPoKmXbvbWnnm3ZrLZZZD7hWoAIQSQCSeMZFViLadKx5bUlN2YUttx1zmQnBU4fmV3/rYAG7uBwMV9ybZpJ91xxy4RT4jzbikl5BBDY+RGCewPOD61DeN7WXWLJ9rLE1d7ep5MdcphD6lEBoOAnIGSOPUDkj0B5qDtd1TqS+pdYl+DbIqiY6UrwuasZBWR38IEED+0QT2AzgCx6UDS2/tdkhTS2QTJTlIWsqWc5yVKyASTkgDPAAqUsMHTcOapUGXDW845uAS4grJAwBkHJAAAAGAAO1TcFww8WTuti1UpSqFRSlKAUpSgFKUoBSlKA8t9Z4970fqu9hhx1Nq1Ble44CVb3ErWN3oQoqBHqlRz353JpR4/Zmm7bEaRK8pBRskpcBaKggICwQcqBQpRAGQcjkcGq31dZlP6hQq/ynBpxDiUCG4kJYk72ygHxQCUOBayQFYHyJIwAVpqFj1BfdPGKl2ZafwVbQjyjd6kMtSvBwMArZJTk5wMkjABIGDXKpKE3Z1dJ6NKL92DtyXd7f8N13WRIt91gyJTQfxvQHkYBShQBUCknjlKMEZzyCByT5x6iT7m/rvUNitrglJvcplTqGsur3NnKGskkggkZSO2AAABirC/1Mvt9jy4ulIdltc+IooWZcsvuPAqVgtAthGMIPKhjChjHeunT9nnGRCnWBU2HqNtySZEqRGackzHSRuCUBa0tNAoxvUoA7u4yMxkyKX7S/WegZepglleiu9/ybN19o+7PdDfwRtDXn7gzHitpSFpb8UtuNqUQVEAcJJGSPasbU9g1Lq66P3Z+yOWpqFZJsSDFfkNKkSX5De07vDWpCEAAAZWck5OKkviEcfa6NXtwKUh3YwD4ayCSX2wQDx3zj071gxbk/o+36fiwNKiwN3a/ohyI8uQH1bFNE+IlSHFAElAABJ7HjkGvVwuSxKvn+FZ5TjGFR7Io0nTN1dmP6bVpdm6XNOhoMEpW80DEfIdRvyo4IBBJKCTwMA5OMvXPT/XM6H9msQETSxBgNxZccQ0b3GQnxS846PH3ZT8mwgYPJHINlk6/vzrrqbazZxIVq02Fp5xla0hgIKgs4WCVA57EA9sDOaStf6kZ0de5SnrQm82u+LtLKUwHHEXBzCfCQhvxklClFYyStQABOD6be5kTTSRVxi092ZCNBPSovUPzdqiJn3x59ECS8EKKmywhKDkZKQF5ODg5GcdqhGdD3wosbzGlm7a9H01Nt0xIcjgrkKbQhGShZCgshRBPYHnBOKzdQaquWmdU3O43S3QpN0g6QRLfVHceShbvjkFABUUhAJznbuxnJxxWTO11qmyyZ8O5Gyz306bevUZ2JHcbQ2pvA8NaS4orSSRhQKScHgZ4qnlXH+2LfRtZg2jpotqfYXJGmLeGWNKriTAUMkedPh4yATuV/xPnGRyeeeYE9M9TvQLQzeLfcZTH4Os2x9iG9BLkd1JXuBVISoBBCh87R3AgcHAxZldSNRWpVyN5iW2Z4WmE36OmGy40Ukq2lpZUtW4AkHcAOM8VOdMtS6yvVxdZ1FYxGhriIkR5QaQyConBQEh90qGCCF5TnByBxU68yi3tX+/JFQbKlqbpzdpsXWxbsqJcuTbrexaH3nmlulxpsBZCyQUkEDJITkjIrL1BoK+yrvr9uBbWGTqGEyYNxS42kNrS2EutL53grIzkAggkkg8Gua3t13vXU/W0Ow225yL0g20W+4MSg01biWwVqWSsHBAPASrOCMDPNy1P1Cu9mg6+dSi3qd04qImF4qFDxS62gkrAWM5KjjGO3rWl5KWl81/XyEo3uZOhdN3CPrs6h/B1vTEBFoRAXCS40TIeCwvxSGiU4SAQCTuIJyAOKq+sdC6imuapjo0vGusq43difDuq5DSVNMAt5aG87wpIQQAAEkKPOeDzeL/fdOav6k3+0vWgNwG4Eh+PMbWpT48EDakpWNhIJAJCsnAx6113bUl8sOruoeo7Q5a20xIVtlPxZzS1uOgtEBCSladh5IyQrJwMc5qIxyRlqTXb+vyVdNU7MxfT27u9QrjMuEe6SWX741cYsuK9DQ22hOzCXFLSZAKdpG1B2kYHGST92DROqYl3sMhduQgRLzd5LqlvoUlCHwoMqICiSCSMgZIzyBURqe5Bl3qfclQ0PZkWVfguuOIAKktjBLakKyM54IGRzkZB2HaNTXy76mvyWnrXBtFkmeVeZfYWuS9hpKy4FhYCBlXA2KyAeRUSllgrX+2X5JSg/JUul+kNW2zXlvvF3tJiNt2t+LLUgQ22S6VoKQ2iOAS2QCQV5UCDkDjO6Aa1R086hXy/a0jWidGYXbp1tcnQ5aIKo3iBK0pBQFPOFSCFHBUlB47VtcdsCubqXPUtaSNMVU6PquD3rmuD3rnNjzx1A6O3pHUqPqfTzaJcGRcG5MhneEuMErClkAkAjOSMHIzjHGT6GSMAfdXIxQVSMFFtozhjUG2jmlKVc0FKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoD4z61Vta6C0zq/w1Xq3BbzeNj7Si24ACDtKhyRkZwcirVT7qiSUlTL48k8b1QdM1M/0UsT2p48l8B20MpB8s44ta3Vg5AUScbc9wMZGBUjrHpDpG8wWBbrPb7bKjPBxpbTAQheTlSFhOMg8/UHGPatkVyKyWGCVVybPrc7alrdr5KDZ+k+jLfLjTlWpD0pjChvcWpsLHYhCiRxk4znFXxKdqcJAA9AK5HFc81pGKiqSMsufJmdzk2Yd4hIuNqlQHFKSiQytoqT3AUCCR++tFvfD7I8VRbvyQgk4BaGcema3/wC1DmjgpcnHm6bFmaeRWefvyfJf6/R/CFPyfJf6/R/CFegv2U/ZVfah4MP03pvtPPh+H2Yf+fI/hCtj6X07q/T1iiWaFc7YtiK3sQpyOSojJPJCh71e/wDzTOKmONRdo1w9JhwNuCoq/l9dfrG0f5VX81PL66/WNo/yqv5qtVKudRVfL65/WVo/yqv5qp3UPprqDXC4arreITRiBfh+AxjO7Gc5J9hW2TyKdv8AWqyipKmaYM88E1OHKPPX5O0n9fI/hCn5O0r9fI/hCvQ3NOaz9iHg9H9a637zzz+TvJH/AD5P8IVIaa6FSbRfYV0F9yYzwcAS2ATj0yK3rQZ5qVhgndFJ+r9XOLjKezCBhIBOcACvqlK1PNFKUoBSlKAUpSgFKUoDokMtPsLZebS42sFKkLSClQIwQQeCD2waqSem+j06hi3lNnjoXEbCI8ZtsJjNkEELDYAAWCBz9AcZAIufr70PaoaT5RaM5RVJ0V3VGjtP6kfhybrBDkiG4FsvNqLbifdO5JB2nJyM1J2y02y2Bz7Ot0SH4p3OeAylvefc4AyfqakB2rilLka5NVZhXe2wLvb3Lfc4jMuI5jxGXUhSFYIIyD7EA/srqv1ktF9t5t15t8afEKgosyGwtJI7HB9R71JHvTHNSm1wylJkFD0ppuEw1Hh2OBGZYlCW022wEpQ8E7QsADAIAAyPSuq56M0pdGHWJ9gt8lp6UZjiHGQQt8gJLh91EADPtVipx2zVtcrvuRpVUQ0PTVgiJAjWeE3iGIIAZGPLgk+FjsUZJ47c1jWrRmlLVEmQ7bp62xI89BblNsx0pS8kgjaoAcjBPHbk+9WLFBUa5eRpWxFiw2YSfMJtkXxfKCFuLQJ8uDnwjnujPp2rG09pTTenXH3LFY4FsW/gOqjMJQVAHIBIHYZPHap2lRqlVWTSMGNbLfFuMu4sRGmpc3Z5l5KQFO7BhG4+uAcCoy86M0pergq43bTtsmy1I8NTz0ZK1lOMYyRntx93FWEffXNIycXaYpPkrly0VpO5XMXO4adtcqbvSvx3oyVLykAJOSM8AAfsFLro3Sl2uP2hc9O2yZMC0r8Z+OlaiUgAHJHoABjtwKsXFOKt7kvJGlENL05YZZneatMR37QU0qXubB8ct48Mq9ynAx7Yr4kaV03JvyL9IsduduiAAmWuMkujAwPmIzwOAfQcVOftpUKUvJNLwV2xaM0pYpxn2XTttt8ohSS7HjpQvCiCRkDsSBx24qxdq4GfcV9DtUOTk7bsKKXCFcHvXNKEilKUApSlAKUpQClKUApSlAKUpQClKUApSlAKUpQClKUApSlAKUpQClKUApSlAKUpQClKUApSlAKUpQClKUApSlAKUpQClKUApilKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgFKUoBSlKAUpSgGKUpQClKUB/9k=" alt="POC - Programma Operativo Complementare" class="sidebar-inst-img">
    </div>
    ${currentUser ? `
    <div class="user-pill">
      <div class="user-avatar">${(currentUser.email || '?')[0].toUpperCase()}</div>
      <div class="user-info">
        <div class="user-email">${currentUser.email || ''}</div>
      </div>
      <button class="user-logout" onclick="doLogout()">Esci</button>
    </div>
    ` : ''}
  `;

  document.getElementById('sidebar').innerHTML = html;
}

function renderStats() {
  const filtered = getFilteredData();
  const total = filtered.length;
  const done = filtered.filter(d => checkedItems.has(d.id)).length;
  const na = filtered.filter(d => naItems.has(d.id)).length;
  const remaining = total - done - na;

  document.getElementById('statsRow').innerHTML = `
    <div class="stat-card">
      <div class="stat-value">${total}</div>
      <div class="stat-label">Requisiti totali</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${done}</div>
      <div class="stat-label">Verificati</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${na}</div>
      <div class="stat-label">Non applicabili</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${remaining}</div>
      <div class="stat-label">Da verificare</div>
    </div>
  `;
}

function renderContent() {
  const filtered = getFilteredData();

  if (filtered.length === 0) {
    document.getElementById('content').innerHTML = `
      <div class="empty-state">
        <div class="icon">üîç</div>
        <p>Nessun requisito trovato per i criteri selezionati.</p>
      </div>
    `;
    return;
  }

  const groups = groupBySection(filtered);
  let html = '';

  for (const sec of SECTION_ORDER) {
    if (!groups[sec]) continue;
    const items = groups[sec];
    const icon = SECTION_ICONS[sec] || 'üìå';
    const color = SECTION_COLORS[sec] || '#3B82F6';
    const isCollapsed = collapsedSections.has(sec);
    const doneInSec = items.filter(d => checkedItems.has(d.id)).length;
    const naInSec = items.filter(d => naItems.has(d.id)).length;

    html += `
      <div class="section-group">
        <div class="section-header" onclick="toggleSection('${sec.replace(/'/g, "\\'")}')">
          <span class="section-icon">${icon}</span>
          <span class="section-name">${sec}</span>
          <span class="section-count">${doneInSec}/${items.length - naInSec} ‚úì${naInSec > 0 ? ' ¬∑ ' + naInSec + ' N/A' : ''}</span>
          <span class="section-toggle ${isCollapsed ? 'collapsed' : ''}">‚ñæ</span>
        </div>
    `;

    if (!isCollapsed) {
      html += '<div class="req-list">';
      // Group by subtopic within section
      for (const item of items) {
        const isChecked = checkedItems.has(item.id);
        const isNA = naItems.has(item.id);
        const cardClass = isChecked ? 'checked' : (isNA ? 'na' : '');
        const subtopicTag = item.subtopic
          ? `<div class="req-subtopic" style="color: ${color}">${item.subtopic}</div>`
          : '';
        const fonteUrl = FONTE_URLS[item.fonte] || '';
        const fonteLink = fonteUrl
          ? `<a href="${fonteUrl}" target="_blank" rel="noopener noreferrer" class="req-fonte-link">üîó Link alla fonte</a>`
          : '';

        html += `
          <div class="req-card ${cardClass}" id="card-${item.id}">
            <div class="req-actions-left">
              <div class="req-check ${isChecked ? 'checked' : ''}" onclick="toggleCheck(${item.id})"></div>
              <button class="req-na ${isNA ? 'active' : ''}" onclick="toggleNA(${item.id})" title="Segna come non applicabile">N/A</button>
              <div class="req-expand" onclick="toggleExpand(${item.id})" title="Mostra riferimento normativo">‚ÑπÔ∏è</div>
            </div>
            <div class="req-body">
              ${subtopicTag}
              <div class="req-text">${item.requisito}</div>
              <div class="req-ref">
                <strong>Riferimento:</strong> ${item.ref}
                ${fonteLink ? '<br>' + fonteLink : ''}
              </div>
            </div>
          </div>
        `;
      }
      html += '</div>';
    }

    html += '</div>';
  }

  document.getElementById('content').innerHTML = html;
}

function render() {
  renderSidebar();
  renderStats();
  renderContent();
}

function setSection(sec) {
  activeSection = sec;
  render();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function toggleCheck(id) {
  if (checkedItems.has(id)) {
    checkedItems.delete(id);
  } else {
    checkedItems.add(id);
    naItems.delete(id); // remove from N/A if checking
  }
  saveState();
  render();
}

function toggleNA(id) {
  if (naItems.has(id)) {
    naItems.delete(id);
  } else {
    naItems.add(id);
    checkedItems.delete(id); // remove from checked if marking N/A
  }
  saveState();
  render();
}

function toggleExpand(id) {
  const card = document.getElementById('card-' + id);
  if (card) card.classList.toggle('expanded');
}

function toggleSection(sec) {
  if (collapsedSections.has(sec)) {
    collapsedSections.delete(sec);
  } else {
    collapsedSections.add(sec);
  }
  renderContent();
}

function toggleShowChecked() {
  showOnlyChecked = !showOnlyChecked;
  if (showOnlyChecked) { showOnlyUnchecked = false; showOnlyNA = false; }
  updateFilterButtons();
  render();
}

function toggleShowUnchecked() {
  showOnlyUnchecked = !showOnlyUnchecked;
  if (showOnlyUnchecked) { showOnlyChecked = false; showOnlyNA = false; }
  updateFilterButtons();
  render();
}

function toggleShowNA() {
  showOnlyNA = !showOnlyNA;
  if (showOnlyNA) { showOnlyChecked = false; showOnlyUnchecked = false; }
  updateFilterButtons();
  render();
}

function updateFilterButtons() {
  document.getElementById('btnShowChecked').classList.toggle('active', showOnlyChecked);
  document.getElementById('btnShowUnchecked').classList.toggle('active', showOnlyUnchecked);
  document.getElementById('btnShowNA').classList.toggle('active', showOnlyNA);
}

// Search with debounce
let searchTimeout;
document.getElementById('searchInput').addEventListener('input', (e) => {
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(() => {
    searchQuery = e.target.value.trim();
    renderStats();
    renderContent();
  }, 250);
});


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUTH FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showLogin() {
  document.getElementById('authFormLogin').style.display = '';
  document.getElementById('authFormRegister').style.display = 'none';
  document.getElementById('authError').textContent = '';
}
function showRegister() {
  document.getElementById('authFormLogin').style.display = 'none';
  document.getElementById('authFormRegister').style.display = '';
  document.getElementById('regError').textContent = '';
}

async function doLogin() {
  const email = document.getElementById('authEmail').value.trim();
  const password = document.getElementById('authPassword').value;
  document.getElementById('authError').textContent = '';
  if (!email || !password) { document.getElementById('authError').textContent = 'Compila tutti i campi'; return; }
  const { error } = await sbClient.auth.signInWithPassword({ email, password });
  if (error) {
    const msg = error.message.includes('Invalid login') ? 'Email o password non validi' : error.message;
    document.getElementById('authError').textContent = msg;
  }
}

async function doRegister() {
  const email = document.getElementById('regEmail').value.trim();
  const pw1 = document.getElementById('regPassword').value;
  const pw2 = document.getElementById('regPassword2').value;
  document.getElementById('regError').textContent = '';
  if (!email || !pw1) { document.getElementById('regError').textContent = 'Compila tutti i campi'; return; }
  if (pw1 !== pw2) { document.getElementById('regError').textContent = 'Le password non coincidono'; return; }
  if (pw1.length < 6) { document.getElementById('regError').textContent = 'La password deve avere almeno 6 caratteri'; return; }
  const { error } = await sbClient.auth.signUp({ email, password: pw1 });
  if (error) {
    document.getElementById('regError').textContent = error.message;
  } else {
    document.getElementById('regError').style.color = '#059669';
    document.getElementById('regError').textContent = 'Account creato! Controlla la tua email per confermare, poi accedi.';
  }
}

async function doLogout() {
  await sbClient.auth.signOut();
  currentUser = null;
  currentCompId = null;
  compilazioni = [];
  checkedItems = new Set();
  naItems = new Set();
}

// Enter key for login/register
document.getElementById('authPassword').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });
document.getElementById('regPassword2').addEventListener('keydown', e => { if (e.key === 'Enter') doRegister(); });

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COMPILAZIONI CRUD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadCompilazioni() {
  const { data, error } = await sbClient
    .from('compilazioni')
    .select('id, nome_acquisto, created_at, updated_at')
    .eq('user_id', currentUser.id)
    .order('updated_at', { ascending: false });
  if (error) { console.error(error); return; }
  compilazioni = data || [];
  renderCompSelect();
}

function renderCompSelect() {
  const sel = document.getElementById('compSelect');
  sel.innerHTML = '<option value="">‚Äî Seleziona o crea un acquisto ‚Äî</option>';
  for (const c of compilazioni) {
    const d = new Date(c.updated_at).toLocaleDateString('it-IT');
    const opt = document.createElement('option');
    opt.value = c.id;
    opt.textContent = `${c.nome_acquisto} (agg. ${d})`;
    if (c.id === currentCompId) opt.selected = true;
    sel.appendChild(opt);
  }
}

async function switchCompilazione() {
  const id = document.getElementById('compSelect').value;
  if (!id) {
    currentCompId = null;
    checkedItems = new Set();
    naItems = new Set();
    render();
    return;
  }
  const { data, error } = await sbClient
    .from('compilazioni')
    .select('*')
    .eq('id', id)
    .single();
  if (error || !data) { console.error(error); return; }
  currentCompId = data.id;
  checkedItems = new Set(data.checked_items || []);
  naItems = new Set(data.na_items || []);
  render();
}

async function newCompilazione() {
  const nome = prompt('Nome dell\'acquisto (es. "Gestionale tributi 2026"):');
  if (!nome || !nome.trim()) return;
  const { data, error } = await sbClient
    .from('compilazioni')
    .insert({ user_id: currentUser.id, nome_acquisto: nome.trim(), checked_items: [], na_items: [] })
    .select()
    .single();
  if (error) { alert('Errore: ' + error.message); return; }
  currentCompId = data.id;
  checkedItems = new Set();
  naItems = new Set();
  await loadCompilazioni();
  render();
}

async function renameCompilazione() {
  if (!currentCompId) { alert('Seleziona prima un acquisto'); return; }
  const current = compilazioni.find(c => c.id === currentCompId);
  const nome = prompt('Nuovo nome:', current?.nome_acquisto || '');
  if (!nome || !nome.trim()) return;
  await sbClient.from('compilazioni').update({ nome_acquisto: nome.trim() }).eq('id', currentCompId);
  await loadCompilazioni();
}

async function deleteCompilazione() {
  if (!currentCompId) { alert('Seleziona prima un acquisto'); return; }
  const current = compilazioni.find(c => c.id === currentCompId);
  if (!confirm(`Eliminare definitivamente "${current?.nome_acquisto}"?`)) return;
  await sbClient.from('compilazioni').delete().eq('id', currentCompId);
  currentCompId = null;
  checkedItems = new Set();
  naItems = new Set();
  await loadCompilazioni();
  render();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUTH STATE LISTENER + INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showAuthScreen() {
  document.getElementById('loadingOverlay').style.display = 'none';
  document.getElementById('authOverlay').style.display = 'flex';
}

function showError(msg) {
  const lo = document.getElementById('loadingOverlay');
  lo.querySelector('.spinner').style.display = 'none';
  lo.querySelector('.loading-text').textContent = '‚ö†Ô∏è ' + msg;
}

// Global safety net: no matter what, stop spinning after 5s
const _globalTimeout = setTimeout(() => {
  const lo = document.getElementById('loadingOverlay');
  if (lo && lo.style.display !== 'none') {
    console.warn('CheckICT: timeout globale raggiunto, mostro login.');
    showAuthScreen();
  }
}, 5000);

// Clear the independent failsafe since main script is running
if (window._clearInitTimeout) window._clearInitTimeout();

if (sbClient) {
  try {
    sbClient.auth.onAuthStateChange(async (event, session) => {
      clearTimeout(_globalTimeout);
      const loading = document.getElementById('loadingOverlay');
      const authOv = document.getElementById('authOverlay');
      const app = document.getElementById('appContainer');

      if (session?.user) {
        currentUser = session.user;
        authOv.style.display = 'none';
        loading.style.display = 'flex';

        try { await loadCompilazioni(); } catch(e) { console.error('Errore caricamento compilazioni:', e); }

        loading.style.display = 'none';
        app.classList.remove('app-hidden');
        render();
      } else {
        currentUser = null;
        app.classList.add('app-hidden');
        loading.style.display = 'none';
        authOv.style.display = 'flex';
      }
    });

    // Backup: check session explicitly
    sbClient.auth.getSession().then(({ data: { session } }) => {
      if (!session) {
        clearTimeout(_globalTimeout);
        showAuthScreen();
      }
    }).catch(e => {
      clearTimeout(_globalTimeout);
      console.error('Errore getSession:', e);
      showAuthScreen();
    });
  } catch(e) {
    clearTimeout(_globalTimeout);
    console.error('Errore init auth:', e);
    showAuthScreen();
  }
} else if (!_supabaseError) {
  clearTimeout(_globalTimeout);
  showError('Errore inizializzazione Supabase.');
}
</script>

</body>
</html>